import{r as a,O as l,e,w as s,x as t,c,f as u,h as o,k as i,t as n,i as d,j as f,F as p,A as r,G as _,H as v,l as m,s as h,a5 as g,J as y,D as k,a1 as w,q as b,a6 as C,v as j,L as x,S as q,y as V,U as $,I}from"./index-n3EudtRm.js";import{_ as Q}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=Q({__name:"add",setup(Q){const F=a(""),P=a([]),L=a(""),D=a("public"),U=a([]),M=a(!1),S=l((()=>({public:"ÂÖ¨ÂºÄ",friends:"‰ªÖÂ•ΩÂèãÂèØËßÅ",private:"‰ªÖËá™Â∑±ÂèØËßÅ"}[D.value]))),T=l((()=>F.value.trim()||P.value.length>0)),A=["üòä","üòÇ","ü§£","‚ù§Ô∏è","üòç","ü§î","üòí","üëç","üëé","üò≥","ü•∫","üò≠","üòò","ü§ó","üôÑ","üò¥","ü§Æ","ü§ß","üò∑","ü§í","ü§ï","üòà","üëª","üëΩ","ü§ñ","üí©","üò∫","üí™","üëä","‚úåÔ∏è","ü§û","üôè","üëè","üôå","üëê","ü§≤"],E=a(!1),G=()=>{E.value=!E.value},H=()=>{_()},J=async()=>{if(T.value){M.value=!0;try{v({title:"ÂèëÂ∏É‰∏≠..."});const{result:a}=await m.callFunction({name:"wx_add_moment",data:{content:F.value,mediaList:P.value,location:L.value,privacy:D.value,contactType:N.value,contactValue:R.value}});if(0!==a.code)throw new Error(a.msg);h({title:"ÂèëÂ∏ÉÊàêÂäü",icon:"success"}),g("refreshMoments"),setTimeout((()=>{_()}),1500)}catch(a){h({title:a.message||"ÂèëÂ∏ÉÂ§±Ë¥•",icon:"none"})}finally{y(),M.value=!1}}},O=()=>{k({itemList:["ÊãçÊëÑ","‰ªéÁõ∏ÂÜåÈÄâÊã©"],success:a=>{0===a.tapIndex||w({count:9-P.value.length,success:async a=>{v({title:"‰∏ä‰º†‰∏≠..."});try{const l=await(async a=>{console.log("uploadImages",a[0]);try{const l=a.map((a=>new Promise(((l,e)=>{m.uploadFile({filePath:a,cloudPath:`wx-moments/${Date.now()}-${Math.random().toString(36).slice(-6)}${a.match(/\.[^.]+$/)}`,success:a=>{l({type:"image",url:a.fileID})},fail:e})}))));return await Promise.all(l)}catch(l){return console.error(l),h({title:l.message||"ÂõæÁâá‰∏ä‰º†Â§±Ë¥•",icon:"none"}),[]}})(a.tempFilePaths);P.value.push(...l)}finally{y()}}})}})},z=()=>{k({itemList:["ÂÖ¨ÂºÄ","‰ªÖÂ•ΩÂèãÂèØËßÅ","‰ªÖËá™Â∑±ÂèØËßÅ"],success:a=>{D.value=["public","friends","private"][a.tapIndex]}})},B=()=>{C({success:a=>{L.value=a.name}})},K=a(!1),N=a("wechat"),R=a(""),W={wechat:"ËØ∑ËæìÂÖ•ÂæÆ‰ø°Âè∑",phone:"ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑",qq:"ËØ∑ËæìÂÖ•QQÂè∑",email:"ËØ∑ËæìÂÖ•ÈÇÆÁÆ±"},X=l((()=>W[N.value])),Y=l((()=>{if(!R.value)return"Êú™Â°´ÂÜô";return`${{wechat:"ÂæÆ‰ø°",phone:"ÊâãÊú∫",qq:"QQ",email:"ÈÇÆÁÆ±"}[N.value]}: ${R.value}`})),Z=()=>{K.value=!K.value},aa=a=>{N.value=a},la=()=>{K.value=!1},ea=()=>{R.value=""};return(a,l)=>{const _=j,v=t,m=x,h=q,g=V,y=$,k=I;return c(),e(v,{class:"publish-container"},{default:s((()=>[u(v,{class:"nav-bar gradient-bar"},{default:s((()=>[u(v,{class:"nav-left"},{default:s((()=>[u(_,{class:"cancel",onClick:H},{default:s((()=>[u(_,{class:"cancel-icon"},{default:s((()=>[o("‚úï")])),_:1}),o(" ÂèñÊ∂à ")])),_:1})])),_:1}),u(v,{class:"nav-center"},{default:s((()=>[u(_,{class:"nav-title"},{default:s((()=>[o("ÂèëÂ∏ÉÂä®ÊÄÅ")])),_:1})])),_:1}),u(v,{class:"nav-right"},{default:s((()=>[u(_,{class:i(["publish",{active:T.value}]),onClick:J},{default:s((()=>[o(" ÂèëË°® ")])),_:1},8,["class"])])),_:1})])),_:1}),u(v,{class:"content-area"},{default:s((()=>[u(v,{class:"input-header"},{default:s((()=>[u(_,{class:"input-label"},{default:s((()=>[o("ÂàÜ‰∫´‰Ω†ÁöÑÊÉ≥Ê≥ï")])),_:1}),u(_,{class:"char-count"},{default:s((()=>[o(n(F.value.length)+"/1000",1)])),_:1})])),_:1}),u(m,{class:"content-input",modelValue:F.value,"onUpdate:modelValue":l[0]||(l[0]=a=>F.value=a),placeholder:"Ëøô‰∏ÄÂàªÁöÑÊÉ≥Ê≥ï...ÊîØÊåÅË°®ÊÉÖüòä","placeholder-style":"color: #a0aec0;",maxlength:"1000","auto-height":""},null,8,["modelValue"]),u(v,{class:"input-footer"},{default:s((()=>[u(v,{class:"emoji-toolbar"},{default:s((()=>[u(_,{class:"emoji-btn",onClick:G},{default:s((()=>[u(_,{class:"emoji-icon"},{default:s((()=>[o("üòä")])),_:1}),o(" Ë°®ÊÉÖ ")])),_:1})])),_:1}),u(v,{class:"input-actions"},{default:s((()=>[u(_,{class:i(["word-count",{warning:F.value.length>800}])},{default:s((()=>[o(n(F.value.length),1)])),_:1},8,["class"])])),_:1})])),_:1}),E.value?(c(),e(v,{key:0,class:"emoji-panel"},{default:s((()=>[u(v,{class:"emoji-header"},{default:s((()=>[u(_,{class:"emoji-title"},{default:s((()=>[o("ÈÄâÊã©Ë°®ÊÉÖ")])),_:1}),u(_,{class:"emoji-close",onClick:G},{default:s((()=>[o("‚úï")])),_:1})])),_:1}),u(h,{"scroll-x":"",class:"emoji-list"},{default:s((()=>[(c(),d(p,null,f(A,((a,l)=>u(_,{key:l,class:"emoji-item",onClick:l=>(a=>{F.value+=a})(a)},{default:s((()=>[o(n(a),1)])),_:2},1032,["onClick"]))),64))])),_:1})])),_:1})):r("",!0)])),_:1}),(P.value.length,c(),e(v,{key:0,class:"media-area"},{default:s((()=>[u(v,{class:"media-header"},{default:s((()=>[u(_,{class:"media-title"},{default:s((()=>[o("ÁÖßÁâá")])),_:1}),u(_,{class:"media-count"},{default:s((()=>[o(n(P.value.length)+"/9",1)])),_:1})])),_:1}),u(v,{class:"media-grid"},{default:s((()=>[(c(!0),d(p,null,f(P.value,((a,l)=>(c(),e(v,{key:l,class:"media-item"},{default:s((()=>[u(v,{class:"media-wrapper"},{default:s((()=>["image"===a.type?(c(),e(g,{key:0,src:a.url,mode:"aspectFill",class:"media-img",onClick:a=>(a=>{const l=P.value.filter((a=>"image"===a.type)).map((a=>a.url));b({urls:l,current:l[a]})})(l)},null,8,["src","onClick"])):"video"===a.type?(c(),e(v,{key:1,class:"video-preview-wrap"},{default:s((()=>[u(y,{src:a.url,class:"video-preview"},null,8,["src"]),u(v,{class:"video-overlay"},{default:s((()=>[u(_,{class:"video-play-icon"},{default:s((()=>[o("‚ñ∂")])),_:1}),u(_,{class:"video-duration"},{default:s((()=>[o("00:30")])),_:1})])),_:1})])),_:2},1024)):r("",!0),u(v,{class:"media-actions"},{default:s((()=>[u(_,{class:"delete-btn",onClick:a=>(a=>{P.value.splice(a,1)})(l)},{default:s((()=>[o("‚úï")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),P.value.length<9?(c(),e(v,{key:0,class:"add-btn",onClick:O},{default:s((()=>[u(v,{class:"add-icon"},{default:s((()=>[o("+")])),_:1}),u(_,{class:"add-text"},{default:s((()=>[o("Ê∑ªÂä†")])),_:1})])),_:1})):r("",!0)])),_:1})])),_:1})),u(v,{class:"bottom-options"},{default:s((()=>[u(v,{class:"options-header"},{default:s((()=>[u(_,{class:"options-title"},{default:s((()=>[o("ÂèëÂ∏ÉËÆæÁΩÆ")])),_:1})])),_:1}),u(v,{class:"option-item",onClick:z},{default:s((()=>[u(v,{class:"option-left"},{default:s((()=>[u(_,{class:"option-icon"},{default:s((()=>[o("üëÅÔ∏è")])),_:1}),u(_,{class:"option-label"},{default:s((()=>[o("Ë∞ÅÂèØ‰ª•Áúã")])),_:1})])),_:1}),u(v,{class:"option-right"},{default:s((()=>[u(_,{class:"option-value"},{default:s((()=>[o(n(S.value),1)])),_:1}),u(_,{class:"option-arrow"},{default:s((()=>[o("‚Ä∫")])),_:1})])),_:1})])),_:1}),u(v,{class:"option-item",onClick:B},{default:s((()=>[u(v,{class:"option-left"},{default:s((()=>[u(_,{class:"option-icon"},{default:s((()=>[o("üìç")])),_:1}),u(_,{class:"option-label"},{default:s((()=>[o("ÊâÄÂú®‰ΩçÁΩÆ")])),_:1})])),_:1}),u(v,{class:"option-right"},{default:s((()=>[u(_,{class:"option-value"},{default:s((()=>[o(n(L.value||"Ê∑ªÂä†‰ΩçÁΩÆ"),1)])),_:1}),u(_,{class:"option-arrow"},{default:s((()=>[o("‚Ä∫")])),_:1})])),_:1})])),_:1}),u(v,{class:"option-item",onClick:Z},{default:s((()=>[u(v,{class:"option-left"},{default:s((()=>[u(_,{class:"option-icon"},{default:s((()=>[o("üìû")])),_:1}),u(_,{class:"option-label"},{default:s((()=>[o("ËÅîÁ≥ªÊñπÂºè")])),_:1})])),_:1}),u(v,{class:"option-right"},{default:s((()=>[u(_,{class:"option-value"},{default:s((()=>[o(n(Y.value),1)])),_:1}),u(_,{class:"option-arrow"},{default:s((()=>[o("‚Ä∫")])),_:1})])),_:1})])),_:1}),u(v,{class:"option-item"},{default:s((()=>[u(v,{class:"option-left"},{default:s((()=>[u(_,{class:"option-icon"},{default:s((()=>[o("@")])),_:1}),u(_,{class:"option-label"},{default:s((()=>[o("ÊèêÈÜíË∞ÅÁúã")])),_:1})])),_:1}),u(v,{class:"option-right"},{default:s((()=>[u(_,{class:"option-value"},{default:s((()=>[o(n(U.value.length?`Â∑≤ÈÄâ${U.value.length}‰∫∫`:"Ê∑ªÂä†"),1)])),_:1}),u(_,{class:"option-arrow"},{default:s((()=>[o("‚Ä∫")])),_:1})])),_:1})])),_:1})])),_:1}),K.value?(c(),e(v,{key:1,class:"contact-panel"},{default:s((()=>[u(v,{class:"cp-row"},{default:s((()=>[u(_,{class:"cp-label"},{default:s((()=>[o("ÊñπÂºè")])),_:1}),u(v,{class:"cp-types"},{default:s((()=>[u(_,{class:i(["cp-type","wechat"===N.value?"active":""]),onClick:l[1]||(l[1]=a=>aa("wechat"))},{default:s((()=>[o("ÂæÆ‰ø°")])),_:1},8,["class"]),u(_,{class:i(["cp-type","phone"===N.value?"active":""]),onClick:l[2]||(l[2]=a=>aa("phone"))},{default:s((()=>[o("ÊâãÊú∫")])),_:1},8,["class"]),u(_,{class:i(["cp-type","qq"===N.value?"active":""]),onClick:l[3]||(l[3]=a=>aa("qq"))},{default:s((()=>[o("QQ")])),_:1},8,["class"]),u(_,{class:i(["cp-type","email"===N.value?"active":""]),onClick:l[4]||(l[4]=a=>aa("email"))},{default:s((()=>[o("ÈÇÆÁÆ±")])),_:1},8,["class"])])),_:1})])),_:1}),u(v,{class:"cp-row"},{default:s((()=>[u(_,{class:"cp-label"},{default:s((()=>[o("Âè∑Á†Å/Ë¥¶Âè∑")])),_:1}),u(k,{class:"cp-input",modelValue:R.value,"onUpdate:modelValue":l[5]||(l[5]=a=>R.value=a),placeholder:X.value},null,8,["modelValue","placeholder"])])),_:1}),u(v,{class:"cp-actions"},{default:s((()=>[u(_,{class:"cp-btn ghost",onClick:ea},{default:s((()=>[o("Ê∏ÖÁ©∫")])),_:1}),u(_,{class:"cp-btn primary",onClick:la},{default:s((()=>[o("ÂÆåÊàê")])),_:1})])),_:1})])),_:1})):r("",!0),M.value?(c(),e(v,{key:2,class:"tech-loading"},{default:s((()=>[(c(),d(p,null,f(4,(a=>u(v,{class:"dot",key:a}))),64)),u(_,{class:"loading-text"},{default:s((()=>[o("ÂèëÂ∏É‰∏≠...")])),_:1})])),_:1})):r("",!0)])),_:1})}}},[["__scopeId","data-v-d9338775"]]);export{F as default};
