import{r as a,N as e,o as l,b as s,e as t,w as c,a as o,s as i,v as u,c as n,f as d,i as r,j as f,F as p,k as m,h as _,t as g,z as v,A as k,l as b,V as h,m as y,x as C,O as j,P as x,q,S as w,y as F}from"./index-BG1tn67b.js";import{_ as M}from"./uni-popup.bg1yl4ip.js";import{r as P}from"./uni-app.es.DDvCcZ8H.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const S=I({__name:"goodsList",setup(I){const S=a([{image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg"},{image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg"},{image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg"}]),z=a([{id:1,name:"æ¨è",icon:"ğŸ”¥"},{id:2,name:"æ–°å“",icon:"ğŸ†•"},{id:3,name:"å¥¶èŒ¶",icon:"ğŸ§‹"},{id:4,name:"æœèŒ¶",icon:"ğŸŠ"},{id:5,name:"å’–å•¡",icon:"â˜•ï¸"},{id:6,name:"å°åƒ",icon:"ğŸª"},{id:7,name:"åŠ æ–™",icon:"ğŸ§‡"}]),A=a([]),O=a(0),R=a(!1),$=a(!1),L=a({}),N=a(null),Q=e((()=>Object.values(L.value).reduce(((a,e)=>a+e),0))),T=e((()=>A.value.reduce(((a,e)=>{const l=L.value[e.id]||0;return a+e.price*l}),0))),V=e((()=>A.value.filter((a=>L.value[a.id])).map((a=>({...a,count:L.value[a.id]}))))),B=(a,e)=>{const l=(L.value[a.id]||0)+e;if(!(l<0)){if(0===l)delete L.value[a.id];else{if(l>a.stock)return void i({title:"åº“å­˜ä¸è¶³",icon:"none"});L.value[a.id]=l}G()}},D=()=>{T.value<20?i({title:`è¿˜å·®${(20-T.value).toFixed(2)}å…ƒèµ·é€`,icon:"none"}):b({url:"/pages/shop/store/checkout"})},E=()=>{h({title:"æç¤º",content:"ç¡®å®šæ¸…ç©ºè´­ç‰©è½¦å—ï¼Ÿ",success:a=>{a.confirm&&(L.value={},G(),N.value.close())}})},G=()=>{y("cartItems",L.value)},H=()=>{N.value.open()},J=()=>{R.value||U(z.value[O.value].id)},K=async()=>{$.value=!0,await U(z.value[O.value].id),$.value=!1},U=async a=>{R.value=!0;try{setTimeout((()=>{A.value=Array(10).fill().map(((a,e)=>({id:e+1,name:"å•†å“åç§°",description:"å•†å“æè¿°ä¿¡æ¯",price:Math.floor(50*Math.random()+10),image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",stock:Math.floor(100*Math.random()),sold:Math.floor(1e3*Math.random())}))),R.value=!1}),500)}catch(e){console.error(e),i({title:"åŠ è½½å¤±è´¥",icon:"none"}),R.value=!1}};return l((()=>{(()=>{const a=o("cartItems");a&&(L.value=a)})(),U(z.value[0].id)})),(a,e)=>{const l=C,o=j,h=x,y=q,I=u,L=w,G=F,W=P(s("uni-popup"),M);return n(),t(I,{class:"page-container"},{default:c((()=>[d(h,{class:"banner","indicator-dots":!0,autoplay:!0,interval:"3000",circular:""},{default:c((()=>[(n(!0),r(p,null,f(S.value,((a,e)=>(n(),t(o,{key:e},{default:c((()=>[d(l,{src:a.image,mode:"aspectFill",class:"banner-image"},null,8,["src"])])),_:2},1024)))),128))])),_:1}),d(I,{class:"main-content"},{default:c((()=>[d(L,{class:"category-sidebar","scroll-y":""},{default:c((()=>[(n(!0),r(p,null,f(z.value,((a,e)=>(n(),t(I,{class:m(["category-item",{active:O.value===e}]),key:a.id,onClick:a=>(async a=>{O.value!==a&&(O.value=a,await U(z.value[a].id))})(e)},{default:c((()=>[d(y,{class:"category-icon"},{default:c((()=>[_(g(a.icon),1)])),_:2},1024),d(y,{class:"category-name"},{default:c((()=>[_(g(a.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),d(L,{class:"goods-content","scroll-y":"",onScrolltolower:J,"refresher-enabled":"","refresher-triggered":$.value,onRefresherrefresh:K},{default:c((()=>[d(I,{class:"goods-grid"},{default:c((()=>[(n(!0),r(p,null,f(A.value,(a=>(n(),t(I,{class:"goods-item",key:a.id,onClick:e=>(a=>{b({url:`/pages/shop/goods/detail?id=${a.id}`})})(a)},{default:c((()=>[d(l,{src:a.image,mode:"aspectFill",class:"goods-image","lazy-load":""},null,8,["src"]),d(I,{class:"goods-info"},{default:c((()=>[d(y,{class:"goods-name"},{default:c((()=>[_(g(a.name),1)])),_:2},1024),d(y,{class:"goods-desc"},{default:c((()=>[_(g(a.description),1)])),_:2},1024),d(I,{class:"goods-bottom"},{default:c((()=>[d(I,{class:"price-wrap"},{default:c((()=>[d(y,{class:"price"},{default:c((()=>[_("Â¥"+g(a.price),1)])),_:2},1024),a.originalPrice?(n(),t(y,{key:0,class:"original-price"},{default:c((()=>[_("Â¥"+g(a.originalPrice),1)])),_:2},1024)):v("",!0),d(y,{class:"sold"},{default:c((()=>[_("å·²å”®"+g(a.sold)+"+",1)])),_:2},1024)])),_:2},1024),d(G,{class:m(["add-cart-btn",{disabled:!a.stock}]),onClick:k((e=>(a=>{a.stock?B(a,1):i({title:"å•†å“å·²å”®ç½„",icon:"none"})})(a)),["stop"])},{default:c((()=>[d(y,{class:"btn-icon"},{default:c((()=>[_("+")])),_:1})])),_:2},1032,["class","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),R.value?(n(),t(I,{key:0,class:"loading-state"},{default:c((()=>[d(y,{class:"loading-text"},{default:c((()=>[_("åŠ è½½ä¸­...")])),_:1})])),_:1})):v("",!0)])),_:1},8,["refresher-triggered"])])),_:1}),Q.value>0?(n(),t(I,{key:0,class:"cart-bar",onClick:H},{default:c((()=>[d(I,{class:"cart-info"},{default:c((()=>[d(I,{class:"cart-icon-wrap"},{default:c((()=>[d(y,{class:"cart-icon"},{default:c((()=>[_("ğŸ›’")])),_:1}),d(y,{class:"cart-badge"},{default:c((()=>[_(g(Q.value),1)])),_:1})])),_:1}),d(I,{class:"price-info"},{default:c((()=>[d(y,{class:"total-price"},{default:c((()=>[_("Â¥"+g(T.value.toFixed(2)),1)])),_:1}),d(y,{class:"delivery-fee"},{default:c((()=>[_("é…é€è´¹ Â¥"+g(3))])),_:1})])),_:1})])),_:1}),d(G,{class:m(["checkout-btn",{disabled:T.value<20}]),onClick:k(D,["stop"])},{default:c((()=>[_(g(T.value<20?"Â¥20èµ·é€":"å»ç»“ç®—"),1)])),_:1},8,["class"])])),_:1})):v("",!0),d(W,{ref_key:"cartPopup",ref:N,type:"bottom"},{default:c((()=>[d(I,{class:"cart-popup"},{default:c((()=>[d(I,{class:"popup-header"},{default:c((()=>[d(y,{class:"title"},{default:c((()=>[_("è´­ç‰©è½¦")])),_:1}),d(G,{class:"clear-btn",onClick:E},{default:c((()=>[d(y,{class:"icon"},{default:c((()=>[_("ğŸ—‘ï¸")])),_:1}),d(y,null,{default:c((()=>[_("æ¸…ç©º")])),_:1})])),_:1})])),_:1}),d(L,{class:"cart-list","scroll-y":""},{default:c((()=>[(n(!0),r(p,null,f(V.value,(a=>(n(),t(I,{class:"cart-item",key:a.id},{default:c((()=>[d(l,{src:a.image,class:"goods-image",mode:"aspectFill"},null,8,["src"]),d(I,{class:"goods-info"},{default:c((()=>[d(y,{class:"goods-name"},{default:c((()=>[_(g(a.name),1)])),_:2},1024),d(y,{class:"goods-price"},{default:c((()=>[_("Â¥"+g(a.price),1)])),_:2},1024)])),_:2},1024),d(I,{class:"quantity-control"},{default:c((()=>[d(G,{class:"minus-btn",onClick:e=>B(a,-1)},{default:c((()=>[_("-")])),_:2},1032,["onClick"]),d(y,{class:"count"},{default:c((()=>[_(g(a.count),1)])),_:2},1024),d(G,{class:"plus-btn",onClick:e=>B(a,1)},{default:c((()=>[_("+")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-466bee1a"]]);export{S as default};
