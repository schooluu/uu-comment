import{r as a,W as e,e as l,w as s,m as t,c as u,f as c,h as n,k as i,i as o,j as d,F as r,z as p,v,E as m,B as f,a9 as _,ac as h,l as k,K as g,p as b,q as y,a0 as C}from"./index-BkncPEs6.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=x({__name:"add",setup(x){const j=a(""),F=a([]),I=a(""),L=a("public"),V=a([]),w=e((()=>({public:"公开",friends:"仅好友可见",private:"仅自己可见"}[L.value]))),q=e((()=>j.value.trim()||F.value.length>0)),z=()=>{m()},B=()=>{q.value&&console.log("发布内容:",{content:j.value,mediaList:F.value,location:I.value,privacy:L.value,mentions:V.value})},E=()=>{f({itemList:["拍摄","从相册选择"],success:a=>{0===a.tapIndex||_({count:9-F.value.length,success:a=>{const e=a.tempFilePaths.map((a=>({type:"image",url:a})));F.value.push(...e)}})}})},K=()=>{f({itemList:["公开","仅好友可见","仅自己可见"],success:a=>{L.value=["public","friends","private"][a.tapIndex]}})},P=()=>{h({success:a=>{I.value=a.name}})};return(a,e)=>{const m=k,f=t,_=g,h=y,x=C;return u(),l(f,{class:"publish-container"},{default:s((()=>[c(f,{class:"nav-bar"},{default:s((()=>[c(m,{class:"cancel",onClick:z},{default:s((()=>[n("取消")])),_:1}),c(m,{class:i(["publish",{active:q.value}]),onClick:B},{default:s((()=>[n("发表")])),_:1},8,["class"])])),_:1}),c(f,{class:"content-area"},{default:s((()=>[c(_,{class:"content-input",modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=a=>j.value=a),placeholder:"这一刻的想法...","placeholder-style":"color: #999;",maxlength:"1000","auto-height":""},null,8,["modelValue"])])),_:1}),c(f,{class:"media-area"},{default:s((()=>[c(f,{class:"media-grid"},{default:s((()=>[(u(!0),o(r,null,d(F.value,((a,e)=>(u(),l(f,{key:e,class:"media-item"},{default:s((()=>["image"===a.type?(u(),l(h,{key:0,src:a.url,mode:"aspectFill",onClick:a=>(a=>{const e=F.value.filter((a=>"image"===a.type)).map((a=>a.url));b({urls:e,current:e[a]})})(e)},null,8,["src","onClick"])):"video"===a.type?(u(),l(x,{key:1,src:a.url,class:"video-preview"},null,8,["src"])):p("",!0),c(f,{class:"delete-btn",onClick:a=>(a=>{F.value.splice(a,1)})(e)},{default:s((()=>[n("×")])),_:2},1032,["onClick"])])),_:2},1024)))),128)),F.value.length<9?(u(),l(f,{key:0,class:"add-btn",onClick:E},{default:s((()=>[c(m,{class:"iconfont"},{default:s((()=>[n("+")])),_:1})])),_:1})):p("",!0)])),_:1})])),_:1}),c(f,{class:"bottom-options"},{default:s((()=>[c(f,{class:"option-item",onClick:K},{default:s((()=>[c(m,null,{default:s((()=>[n("谁可以看")])),_:1}),c(m,{class:"value"},{default:s((()=>[n(v(w.value),1)])),_:1})])),_:1}),c(f,{class:"option-item",onClick:P},{default:s((()=>[c(m,null,{default:s((()=>[n("所在位置")])),_:1}),c(m,{class:"value"},{default:s((()=>[n(v(I.value||"添加位置"),1)])),_:1})])),_:1}),c(f,{class:"option-item"},{default:s((()=>[c(m,null,{default:s((()=>[n("提醒谁看")])),_:1}),c(m,{class:"value"},{default:s((()=>[n(v(V.value.length?`已选${V.value.length}人`:"添加"),1)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-53d5164b"]]);export{j as default};
