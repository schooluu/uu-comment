import{r as a,o as t,a2 as e,e as o,w as l,k as s,l as c,s as n,a4 as r,x as i,c as u,f as m,h as f,t as p,A as d,u as h,n as g,i as v,j as y,F as b,B as _,H as k,J as w,m as C,a1 as q,a5 as M,q as x,D as T,W as I,v as j,y as F,U as $,I as E,z as L,S}from"./index-D7ax0EFp.js";import{a as U,b as A,c as P,o as D,d as V}from"./uni-app.es.CFvRQMU0.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";const N=z({__name:"index",setup(z){const N=["星河旅人","夏日微风","蓝莓汽水","橙子汽球","夜空守望","晨曦微光","云端漫步","月下独行","白茶清欢","青柠时光","温柔星球","晴空万里","风中诗人","海盐冰沙","山野听风","橘子海岸","银河信使","微光拾梦","晚风邮差","雾里看花","森林之心","雨后初晴","云朵收集者","夏夜萤火"];function Y(){return N[Math.floor(Math.random()*N.length)]}const H=["https://images.unsplash.com/photo-1502685104226-ee32379fefbe?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1527980965255-d3b416303d12?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1531123897727-8f129e1688ce?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1534528741775-53994a69daeb?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1541271696563-3be2f555fc4e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1496345875659-11f7dd282d1d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1552374196-c4e7ffc6e126?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1516822003754-cca485356ecb?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1519345182560-3f2917c472ef?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1542202229-7d93c33f5d07?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1544006659-f0b21884ce1d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1521119989659-a83eee488004?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1546961329-78bef0414d7c?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1601455763557-db1bea8a9a5a?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1580489944761-15a19d654956?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1607746882042-944635dfe10e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1594744803329-e58b31de8bf5?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1568602471122-7832951cc4c5?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1566492031773-4f4e44671857?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1558898479-33c0057a5d12?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1599566150163-29194dcaad36?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506277886164-e25aa3f4ef7f?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1503454537195-1dcabb73ffb9?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1522556189639-b150ed9c4330?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1463453091185-61582044d556?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506919258185-6078bba55d2a?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1499996860823-5214fcc65f8f?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1545996124-0501ebae84d0?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1513956589380-bad6acb9b9d4?auto=format&fit=crop&w=256&q=60"],J=H[Math.floor(Math.random()*H.length)],Q=["https://images.unsplash.com/photo-1557672172-298e090bd0f1?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1506905925346-21bda4d32df4?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1475924156734-496f6cac6ec1?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=1400&q=80"],X=Q[Math.floor(Math.random()*Q.length)],B=J,O=["今天也要元气满满！","匿名分享，轻松自在~","每一天都值得记录。","用心感受生活的美好。","科技让匿名更温暖。","世界很大，心情很美。","做自己的小太阳 ☀️","匿名不孤单，温暖在身边。","记录此刻，遇见更好的自己。","保持好奇，保持热爱！"],W=O[Math.floor(Math.random()*O.length)],G=["匿名树洞 · 美好生活","用温柔治愈世界","每一天都值得记录","让心情自由流动","科技让温暖发生","在这里遇见美好","分享你的故事","做自己的小太阳","世界很大，温暖很近","用匿名守护真心"];a(G[0]);const K=a(""),R=a(!0);let Z=null,aa=0,ta=0;const ea=[{name:"紫罗兰梦境",primary:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",primaryColor:"#667eea",secondary:"#764ba2",accent:"#a855f7",background:"#f8fafc"},{name:"樱花粉境",primary:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",primaryColor:"#f093fb",secondary:"#f5576c",accent:"#ec4899",background:"#fef2f2"},{name:"海洋蓝调",primary:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",primaryColor:"#4facfe",secondary:"#00f2fe",accent:"#06b6d4",background:"#f0f9ff"},{name:"翡翠森林",primary:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",primaryColor:"#43e97b",secondary:"#38f9d7",accent:"#10b981",background:"#f0fdf4"},{name:"落日余晖",primary:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",primaryColor:"#fa709a",secondary:"#fee140",accent:"#f59e0b",background:"#fffbeb"}],oa=a(0),la=a(ea[0]);let sa=null;function ca(){sa=setInterval((()=>{oa.value=(oa.value+1)%ea.length,la.value=ea[oa.value],console.log("切换主题:",la.value.name)}),3e3)}function na(){clearTimeout(Z);const a=G[aa];K.value="",ta=0,function t(){ta<=a.length?(K.value=a.slice(0,ta),ta++,Z=setTimeout(t,60)):setTimeout((()=>{aa=(aa+1)%G.length,na()}),1800)}()}t((()=>{na(),setInterval((()=>{R.value=!R.value}),500),qt(),ca()})),e((()=>{sa&&clearInterval(sa),Z&&clearTimeout(Z)}));const ra=a(!1),ia=a(!1),ua=a(""),ma=a([]),fa=a(-1),pa=a({}),da=a(1),ha=a(10),ga=a(!1),va=a(!0),ya=a([]),ba=async(a=!1)=>{if(!ga.value&&(va.value||a))try{ga.value=!0;const e=new Promise((a=>setTimeout(a,800))),[{result:o}]=await Promise.all([c.callFunction({name:"wx_get_list",data:{page:a?1:da.value,pageSize:ha.value}}),e]);if(0!==o.code)throw new Error(o.msg);{console.log("接收到的原始数据:",o.data.list[0]);const e=o.data.list.map((a=>{var t;return console.log("处理动态，评论数量:",null==(t=a.comments)?void 0:t.length),a.comments&&a.comments.length>0&&console.log("第一条评论:",a.comments[0]),{...a,username:Y(),avatar:H[Math.floor(Math.random()*H.length)],comments:(a.comments||[]).map((a=>(console.log("评论的images字段:",a.images),{...a,images:a.images||[],username:Y(),avatar:H[Math.floor(Math.random()*H.length)]}))),likes:(a.likes||[]).map((()=>Y()))}}));if(console.log("处理后的数据:",e[0]),a)ya.value=e,da.value=2;else{const a=new Set((ya.value||[]).map((a=>a._id))),t=e.filter((t=>!a.has(t._id)));ya.value=[...ya.value||[],...t],da.value++}va.value=o.data.hasMore;try{lt()}catch(t){}}}catch(e){n({title:e.message||"获取朋友圈失败",icon:"none"})}finally{ga.value=!1,a&&r()}};U((()=>{ba(!0),Va(),Da(),za.value=!0,Xa(),setTimeout((()=>{za.value=!1}),5e3),setTimeout((()=>{ba(!0)}),33e3),yt()})),A((()=>{Va(),ht()})),P((()=>{Va(),ht()})),D((()=>{!ga.value&&va.value&&ba()}));const _a=async()=>{if(!ua.value.trim()&&0===ma.value.length)return;const a=ua.value,t=[...ma.value];ra.value=!1,ia.value=!1,ua.value="",ma.value=[],k({title:"发送中...",mask:!0}),console.log("提交评论数据:",{momentId:ya.value[fa.value]._id,content:a,imagesCount:t.length,images:t});try{const{result:e}=await c.callFunction({name:"wx_add_comment",data:{momentId:ya.value[fa.value]._id,content:a,images:t}});if(console.log("云函数返回结果:",e),0!==e.code)throw new Error(e.msg||"评论失败");{const o=ya.value[fa.value];o.comments||(o.comments=[]);const l=H[Math.floor(Math.random()*H.length)];o.comments.push({username:Y(),avatar:l,content:a,images:t,create_time:Date.now(),isNew:!0}),console.log("评论已添加到列表，图片数量:",t.length),setTimeout((()=>{const a=o.comments.length-1;o.comments[a]&&delete o.comments[a].isNew}),500),w();const s=e.msg||"评论成功";n({title:s,icon:"success",duration:1500}),console.log("评论成功:",s)}}catch(e){console.error("评论失败:",e),w(),n({title:e.message||"评论失败",icon:"none",duration:2e3})}},ka=async()=>{C({url:"/pages/wx/home/add"})},wa=()=>{ra.value=!1,ia.value=!1,ua.value="",ma.value=[],fa.value=-1},Ca=()=>{ia.value=!ia.value},qa=()=>{ma.value.length>=3?n({title:"最多上传3张图片",icon:"none"}):q({count:3-ma.value.length,sizeType:["compressed"],sourceType:["album","camera"],success:async a=>{k({title:"上传中..."});try{const t=a.tempFilePaths.map((a=>new Promise(((t,e)=>{M({url:"http://117.72.208.124:40027/api/v1/upload",filePath:a,name:"file",success:a=>{try{const o=JSON.parse(a.data);o.status?t(o.data.links.url):e(new Error(o.message||"上传失败"))}catch(o){e(new Error("解析上传结果失败"))}},fail:a=>{e(a)}})})))),e=await Promise.all(t);ma.value.push(...e),w(),n({title:"上传成功",icon:"success"})}catch(t){w(),n({title:t.message||"上传失败",icon:"none"})}}})},Ma=(a,t)=>{a&&a.length&&x({urls:a,current:t})},xa=()=>{n({title:"视频加载失败",icon:"none"})},Ta=()=>{T({itemList:["切换主题","内容偏好","帮助与反馈"],success:a=>{const t=a.tapIndex;0===t&&n({title:"已切换主题",icon:"none"}),1===t&&n({title:"偏好设置暂未开放",icon:"none"}),2===t&&n({title:"感谢你的反馈",icon:"none"})}})},Ia=a(0);V((a=>{const t=a.scrollTop||0;Ia.value=Math.min(30,.2*t)}));const ja=a("theme-day"),Fa=()=>{const a=(new Date).getHours();ja.value=a>=6&&a<11?"theme-morning":a>=11&&a<18?"theme-day":"theme-night"};t((()=>{Fa(),setInterval(Fa,6e5)}));const $a=a(!1),Ea=a([]);let La=0;const Sa=a=>{const t=Ea.value.findIndex((t=>t.id===a));-1!==t&&Ea.value.splice(t,1)},Ua=(a=4,t=1e3)=>{$a.value=!0;const e=Math.max(1,a),o=Math.floor(t/e);for(let l=0;l<e;l++){setTimeout((()=>{const a=La++;Ea.value.push({id:a,x:Math.floor(10+80*Math.random()),y:Math.floor(18+54*Math.random()),theme:["t-blue","t-violet","t-gold","t-mint","t-pink"][Math.floor(5*Math.random())]}),setTimeout((()=>{Sa(a),0===Ea.value.length&&setTimeout((()=>{$a.value=!1}),800)}),4e3)}),l*o)}},Aa=async a=>{try{const t=ya.value[a];pa.value[a]=!0;const{result:e}=await c.callFunction({name:"wx_add_toggle_like",data:{momentId:t._id}});if(0!==e.code)throw new Error(e.msg);t.isLiked=e.data.isLiked,t.isLiked?(t.likes||(t.likes=[]),t.likes.push(Y())):t.likes.pop(),setTimeout((()=>{pa.value[a]=!1}),1e3)}catch(t){n({title:t.message||"操作失败",icon:"none"})}};let Pa=null;const Da=()=>{Pa||($a.value=!0,Pa=setInterval((()=>{const a=3+Math.floor(3*Math.random()),t=1500+Math.floor(800*Math.random());Ua(a,t)}),2500+Math.floor(1500*Math.random())))},Va=()=>{clearInterval(Pa),Pa=null,$a.value=!1,Ea.value=[]},za=a(!0),Na=a(!1),Ya=["祝","中","国","繁","荣","昌","盛"],Ha=a([]);let Ja=0;const Qa=()=>{Na.value=!0,setTimeout((()=>{Na.value=!1}),600)},Xa=()=>{const a=["#ff00ff","#ff33ff","#ff66ff","#ff99ff","#00ffff","#33ffff","#66ffff","#99ffff","#ffff00","#ffff33","#ffff66","#ffff99","#00ff99","#33ff99","#66ff99","#99ff99"],t=[];setInterval((()=>{const e=20+Math.floor(10*Math.random());for(let o=0;o<e;o++){const e=Ja++,o={id:e,x:30+40*Math.random(),y:25+50*Math.random(),color:a[Math.floor(Math.random()*a.length)],delay:1.2*Math.random(),randomX:Math.random(),randomY:Math.random()};t.push(o),setTimeout((()=>{const a=t.findIndex((a=>a.id===e));-1!==a&&t.splice(a,1)}),5e3)}Ha.value=[...t]}),3e3)},Ba=a=>a||0===a?a>=1e4?(a/1e4).toFixed(1).replace(/\.0$/,"")+"w":a>=1e3?(a/1e3).toFixed(1).replace(/\.0$/,"")+"k":String(a):"0",Oa=a=>{const t=a.likes&&a.likes.length||0,e=a.comments&&a.comments.length||0,o="video"===a.mediaType;return Math.floor(3*t+5*e+(o?18:8))};a("recommend");const Wa=a({});a([{tag:"# 精选",title:"今日热聊：匿名也要有态度",sub:"来一条走心的分享吧"},{tag:"# 新鲜",title:"你的小确幸，值得被看到",sub:"记录当下，温暖一整天"},{tag:"# 附近",title:"发现身边的美好瞬间",sub:"同城热点，马上加入"}]);a([{text:"# 今天你匿名表白了吗",views:"12.3w",posts:"2.1k",emoji:"💌",badge:"热议",badgeType:"badge-hot",cta:"参与"},{text:"# 城市树洞：你的小烦恼",views:"8.7w",posts:"1.2k",emoji:"🌆",badge:"同城",badgeType:"badge-near",cta:"去看看",mood:"氛围很暖"},{text:"# 三件让你快乐的小事",views:"6.5w",posts:"980",emoji:"✨",badge:"精选",badgeType:"badge-new",cta:"我也分享"}]);const Ga=a(!1);let Ka=null;const Ra=[];let Za=Math.floor(Math.random()*Ra.length);const at=()=>Ra[Za%Ra.length],tt=()=>"undefined"==typeof Audio?null:(Ka||(Ka=new Audio(at()),Ka.loop=!0,Ka.preload="auto",Ka.volume=.6,Ka.onerror=()=>{try{const a=(Za=(Za+1)%Ra.length,at());Ka.src=a,Ga.value&&Ka.play().catch((()=>{Ga.value=!1,n({title:"背景音乐需手动播放",icon:"none"})}))}catch(a){}}),Ka),et=["today vibes","mood on","little joy","city walk","coffee o’clock","soft light","daily look","slow life"],ot=a([]),lt=()=>{const a=(()=>{const a=[];return(ya.value||[]).forEach((t=>{"image"===t.mediaType&&Array.isArray(t.mediaUrls)&&t.mediaUrls.forEach((t=>{t&&a.push({url:t})})),Array.isArray(t.mediaList)&&t.mediaList.filter((a=>a&&"image"===a.type&&a.url)).forEach((t=>a.push({url:t.url})))})),a})();if(!a.length)return void(ot.value=[]);const t=a.sort((()=>Math.random()-.5)).slice(0,8);ot.value=t.map((a=>({...a,likes:Math.floor(100+9e3*Math.random()),emoji:["💖","🌸","📸","😊","☕","👗","🧋","✨"][Math.floor(8*Math.random())],caption:et[Math.floor(Math.random()*et.length)]})))},st=()=>{lt()},ct=a=>({beauty:"颜值评分",style:"穿搭评分",photo:"照片评分"}[a]||"评分"),nt=a(!1),rt=a(null),it=a(0),ut=a(""),mt=a(-1);U((()=>{setTimeout((()=>lt()),400),pt()})),A((()=>{dt()})),P((()=>{dt()}));let ft=null;const pt=()=>{ft||(ft=setInterval((()=>{lt()}),5e3))},dt=()=>{ft&&(clearInterval(ft),ft=null)},ht=()=>{if(Ka)try{Ka.pause()}catch(a){}Ga.value=!1};let gt=!1;const vt=()=>{yt()},yt=()=>{const a=tt();a&&(a.muted=!0,a.volume=0,a.play().then((()=>{Ga.value=!0,a.muted=!1,((a=.6,t=1200)=>{const e=Ka;if(!e)return;const o=e.volume||0,l=Math.max(1,Math.floor(t/80));let s=0;const c=setInterval((()=>{s++,e.volume=o+s/l*(a-o),s>=l&&clearInterval(c)}),80)})(.6,1200),"undefined"!=typeof document&&(["touchstart","click","wheel","keydown"].forEach((a=>{try{document.removeEventListener(a,vt)}catch(t){}})),gt=!1)})).catch((()=>{"undefined"==typeof document||gt||(["touchstart","click","wheel","keydown"].forEach((a=>{try{document.addEventListener(a,vt,{once:!0,passive:!0})}catch(t){}})),gt=!0)})))},bt=["😊","😂","🤣","❤️","😍","🤔","😒","👍","👎","😳","🥺","😭","😘","🤗","🙄","😴","🤮","🤧","😷","🤒","🤕","😈","👻","👽","🤖","💩","😺","💪","👊","✌️","🤞","🙏","👏","🙌","👐","🤲"],_t=a(!0),kt=a(10);let wt=null;const Ct=()=>{_t.value=!1,wt&&(clearInterval(wt),wt=null)},qt=()=>{wt=setInterval((()=>{kt.value--,kt.value<=0&&Ct()}),1e3)},Mt=async(a,t)=>{try{k({title:"处理中..."});const t=ya.value[a],{result:e}=await c.callFunction({name:"wx_del",data:{momentId:t._id}});if(0!==e.code)throw new Error(e.msg||"删除失败");ya.value.splice(a,1),w(),n({title:"举报已成功",icon:"none",duration:2e3})}catch(e){w(),n({title:e.message||"操作失败，请重试",icon:"none"})}};return(a,t)=>{const e=j,c=i,r=F,k=$,w=E,C=L,q=S;return u(),o(c,{class:s(["moments-container",ja.value,{"disclaimer-hidden":!_t.value}])},{default:l((()=>[_t.value?(u(),o(c,{key:0,class:"disclaimer-banner"},{default:l((()=>[m(c,{class:"disclaimer-banner-content"},{default:l((()=>[m(c,{class:"disclaimer-banner-left"},{default:l((()=>[m(e,{class:"disclaimer-banner-icon"},{default:l((()=>[f("⚠️")])),_:1}),m(e,{class:"disclaimer-banner-text"},{default:l((()=>[f(" 本网站仅供编程学习交流使用，非商业网站，所有内容均为学习演示，真实性无法保证。请理性对待，切勿轻信。严禁发布违法违规内容，用户需对发布内容负责。 ")])),_:1})])),_:1}),m(c,{class:"disclaimer-banner-right"},{default:l((()=>[m(e,{class:"disclaimer-banner-timer"},{default:l((()=>[f(p(kt.value)+"s",1)])),_:1}),m(e,{class:"disclaimer-banner-close",onClick:Ct},{default:l((()=>[f("✕")])),_:1})])),_:1})])),_:1})])),_:1})):d("",!0),m(c,{class:"header",style:g({background:la.value.background})},{default:l((()=>[m(r,{class:"bg-image",src:h(X),mode:"aspectFill",style:g({transform:`translateY(${Ia.value}px) scale(1.06)`})},null,8,["src","style"]),m(c,{class:"header-gradient",style:g({background:la.value.primary,opacity:.15})},null,8,["style"]),m(c,{class:"header-blur"}),m(c,{class:"header-glow"}),m(c,{class:"header-topbar"},{default:l((()=>[m(e,{class:"brand",style:g({color:la.value.primaryColor})},{default:l((()=>[f("匿名圈")])),_:1},8,["style"]),m(c,{class:"top-actions"},{default:l((()=>[m(e,{class:"top-icon",onClick:Ta},{default:l((()=>[f("⋯")])),_:1})])),_:1})])),_:1}),m(c,{class:"hero-card"},{default:l((()=>[m(r,{class:"hero-avatar",src:h(B),mode:"aspectFill"},null,8,["src"]),m(c,{class:"hero-text"},{default:l((()=>[m(e,{class:"hero-title",style:g({color:la.value.primaryColor})},{default:l((()=>[f(p(h(W)),1)])),_:1},8,["style"]),m(e,{class:"hero-sub"},{default:l((()=>[f("匿名 · 温暖 · 真实")])),_:1}),m(c,{class:"hero-chips"},{default:l((()=>[m(e,{class:"chip active",style:g({background:la.value.primary})},{default:l((()=>[f("推荐")])),_:1},8,["style"]),m(e,{class:"chip"},{default:l((()=>[f("关注")])),_:1}),m(e,{class:"chip"},{default:l((()=>[f("附近")])),_:1})])),_:1})])),_:1})])),_:1}),m(c,{class:"floating-btn",onClick:ka},{default:l((()=>[m(c,{class:"floating-btn-pulse",style:g({background:la.value.primary})},null,8,["style"]),m(c,{class:"floating-btn-inner",style:g({background:la.value.primary})},{default:l((()=>[m(r,{class:"floating-btn-icon",src:"https://img.icons8.com/fluency/48/plus.png",mode:"aspectFit"})])),_:1},8,["style"]),m(e,{class:"floating-btn-label",style:g({color:la.value.primaryColor})},{default:l((()=>[f("发布")])),_:1},8,["style"])])),_:1})])),_:1},8,["style"]),ot.value.length?(u(),o(c,{key:1,class:"photo-showcase"},{default:l((()=>[m(c,{class:"ps-header"},{default:l((()=>[m(e,{class:"ps-title",style:g({color:la.value.primaryColor})},{default:l((()=>[f("最美照片")])),_:1},8,["style"]),m(e,{class:"ps-action",style:g({color:la.value.primaryColor,borderColor:la.value.primaryColor}),onClick:st},{default:l((()=>[f("换一换")])),_:1},8,["style"])])),_:1}),m(c,{class:"ps-row"},{default:l((()=>[(u(!0),v(b,null,y(ot.value,((a,t)=>(u(),o(c,{class:"ps-item",key:t,onClick:a=>(a=>{const t=ot.value.map((a=>a.url));x({urls:t,current:t[a]})})(t)},{default:l((()=>[m(r,{class:"ps-img",src:a.url,mode:"aspectFill"},null,8,["src"]),m(c,{class:"ps-overlay"},{default:l((()=>[m(c,{class:"ps-cap"},{default:l((()=>[m(e,{class:"ps-emoji"},{default:l((()=>[f(p(a.emoji),1)])),_:2},1024),m(e,{class:"ps-text"},{default:l((()=>[f(p(a.caption),1)])),_:2},1024)])),_:2},1024),m(e,{class:"ps-like"},{default:l((()=>[f("❤ "+p(Ba(a.likes)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):d("",!0),m(c,{class:"moments-list"},{default:l((()=>[(u(!0),v(b,null,y(ya.value,((a,t)=>(u(),o(c,{class:"moment-item",key:t},{default:l((()=>[m(r,{class:"user-avatar avatar-glow",src:a.avatar,mode:"aspectFill"},null,8,["src"]),m(c,{class:"content-area"},{default:l((()=>[m(c,{class:"meta-row"},{default:l((()=>[m(e,{class:"username",style:g({color:la.value.primaryColor})},{default:l((()=>[f(p(a.username),1)])),_:2},1032,["style"])])),_:2},1024),m(c,{class:"chip-row"},{default:l((()=>[m(e,{class:"chip",style:g({background:la.value.primary})},{default:l((()=>[f("匿名")])),_:1},8,["style"]),a.mediaType?(u(),o(e,{key:0,class:"chip ghost",style:g({color:la.value.primaryColor,borderColor:la.value.primaryColor})},{default:l((()=>[f("图文")])),_:1},8,["style"])):d("",!0)])),_:2},1024),m(c,{class:s(["text-block",{clamped:!Wa.value[t]}])},{default:l((()=>[m(e,{class:"text-content"},{default:l((()=>[f(p(a.content),1)])),_:2},1024)])),_:2},1032,["class"]),a.content&&a.content.length>60?(u(),o(c,{key:0,class:"expand-btn",style:g({color:la.value.primaryColor}),onClick:a=>(a=>{Wa.value[a]=!Wa.value[a]})(t)},{default:l((()=>[f(p(Wa.value[t]?"收起":"展开"),1)])),_:2},1032,["style","onClick"])):d("",!0),a.mediaType?(u(),o(c,{key:1,class:"media-content"},{default:l((()=>["video"===a.mediaType?(u(),o(k,{key:0,src:a.mediaUrl,poster:a.poster,class:"video-content video-radius",controls:"","show-center-play-btn":"","enable-play-gesture":"","show-fullscreen-btn":"","show-play-btn":"","object-fit":"contain",onError:xa},null,8,["src","poster"])):"image"===a.mediaType?(u(),o(c,{key:1,class:s(["image-gallery",`columns-${a.mediaUrls.length}`])},{default:l((()=>[(u(!0),v(b,null,y(a.mediaUrls,((t,e)=>(u(),o(r,{key:e,src:t,mode:"aspectFill",class:"image-content image-radius",onClick:e=>Ma(a.mediaUrls,t)},null,8,["src","onClick"])))),128))])),_:2},1032,["class"])):d("",!0),m(c,{class:"media-badges"},{default:l((()=>[m(c,{class:"badge ghost"},{default:l((()=>[m(e,{class:"b-ic"},{default:l((()=>[f("🔥")])),_:1}),m(e,{class:"b-txt"},{default:l((()=>[f(p(Ba(Oa(a))),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)):d("",!0),m(c,{class:"bottom-info"},{default:l((()=>[m(e,{class:"time"},{default:l((()=>[f(p(a.time),1)])),_:2},1024),m(c,{class:"actions"},{default:l((()=>[m(c,{class:s(["action-btn like-btn",{liked:a.isLiked,animating:pa.value[t]}]),style:g(a.isLiked?{color:la.value.primaryColor,background:`${la.value.primaryColor}15`}:{}),onClick:a=>(async a=>{await Aa(a),$a.value=!0,Ua(6+Math.floor(3*Math.random()),1200)})(t)},{default:l((()=>[m(e,{class:"icon iconfont"},{default:l((()=>[f(p(a.isLiked?"❤️":"🤍"),1)])),_:2},1024),m(e,{class:"action-text"},{default:l((()=>[f(p(a.isLiked?"已赞":"点赞"),1)])),_:2},1024),m(e,{class:"action-count"},{default:l((()=>[f(p(a.likes&&a.likes.length||0),1)])),_:2},1024),pa.value[t]?(u(),o(c,{key:0,class:"like-burst-particles"},{default:l((()=>[(u(),v(b,null,y(8,(a=>m(c,{key:a,class:s(["particle","p"+a]),style:g({background:la.value.primaryColor})},null,8,["class","style"]))),64))])),_:1})):d("",!0)])),_:2},1032,["class","style","onClick"]),m(c,{class:"action-btn comment-btn",onClick:a=>(a=>{fa.value=a,ra.value=!0})(t)},{default:l((()=>[m(e,{class:"icon iconfont"},{default:l((()=>[f("💬")])),_:1}),m(e,{class:"action-text"},{default:l((()=>[f("评论")])),_:1}),m(e,{class:"action-count",style:g({color:la.value.primaryColor})},{default:l((()=>[f(p(a.comments&&a.comments.length||0),1)])),_:2},1032,["style"])])),_:2},1032,["onClick"]),m(c,{class:"action-btn report-btn",onClick:a=>(a=>{ya.value[a],T({title:"举报内容",itemList:["色情低俗","暴力血腥","政治敏感","诈骗信息","垃圾广告","其他违规"],success:t=>{const e=["色情低俗","暴力血腥","政治敏感","诈骗信息","垃圾广告","其他违规"][t.tapIndex];I({title:"确认举报",content:`确定要举报此内容为"${e}"吗？`,success:t=>{t.confirm&&Mt(a)}})}})})(t)},{default:l((()=>[m(e,{class:"icon iconfont"},{default:l((()=>[f("🚨")])),_:1}),m(e,{class:"action-text"},{default:l((()=>[f("举报")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),a.likes&&a.likes.length?(u(),o(c,{key:2,class:"likes-section"},{default:l((()=>[m(e,{class:"like-users",style:g({color:la.value.primaryColor})},{default:l((()=>[f(p(a.likes.join("、")),1)])),_:2},1032,["style"])])),_:2},1024)):d("",!0),a.contactValue?(u(),o(c,{key:3,class:"contact-section"},{default:l((()=>[m(e,{class:"contact-icon"},{default:l((()=>[f("📞")])),_:1}),m(e,{class:"contact-text",style:g({color:la.value.primaryColor})},{default:l((()=>{return[f(p((t=a.contactType,{wechat:"微信",phone:"手机",qq:"QQ",email:"邮箱"}[t]||"联系"))+"："+p(a.contactValue),1)];var t})),_:2},1032,["style"])])),_:2},1024)):d("",!0),a.ratingType?(u(),o(c,{key:4,class:"rating-section"},{default:l((()=>[m(c,{class:"rating-header"},{default:l((()=>[m(e,{class:"rating-icon"},{default:l((()=>[f("⭐")])),_:1}),m(e,{class:"rating-title"},{default:l((()=>[f(p(ct(a.ratingType)),1)])),_:2},1024),m(e,{class:"rating-range"},{default:l((()=>[f("("+p(a.ratingMin)+"-"+p(a.ratingMax)+"分)",1)])),_:2},1024)])),_:2},1024),a.ratingStats?(u(),o(c,{key:0,class:"rating-stats"},{default:l((()=>[m(c,{class:"rating-avg"},{default:l((()=>[m(e,{class:"avg-score"},{default:l((()=>[f(p(a.ratingStats.average.toFixed(1)),1)])),_:2},1024),m(e,{class:"avg-label"},{default:l((()=>[f("平均分")])),_:1})])),_:2},1024),m(c,{class:"rating-count"},{default:l((()=>[m(e,{class:"count-num"},{default:l((()=>[f(p(a.ratingStats.count),1)])),_:2},1024),m(e,{class:"count-label"},{default:l((()=>[f("人评分")])),_:1})])),_:2},1024)])),_:2},1024)):d("",!0),m(c,{class:"rating-actions"},{default:l((()=>[m(c,{class:"rating-btn",style:g({borderColor:la.value.primaryColor,color:la.value.primaryColor}),onClick:a=>(a=>{mt.value=a,rt.value=ya.value[a],it.value=0,ut.value="",nt.value=!0})(t)},{default:l((()=>[m(e,{class:"rating-btn-icon"},{default:l((()=>[f("⭐")])),_:1}),m(e,{class:"rating-btn-text"},{default:l((()=>[f("评分")])),_:1})])),_:2},1032,["style","onClick"]),m(c,{class:"rating-btn",style:g({borderColor:la.value.primaryColor,color:la.value.primaryColor}),onClick:a=>(a=>{var t,e,o;const l=ya.value[a];I({title:`${ct(l.ratingType)}详情`,content:`平均分：${(null==(e=null==(t=l.ratingStats)?void 0:t.average)?void 0:e.toFixed(1))||0}分\n评分人数：${(null==(o=l.ratingStats)?void 0:o.count)||0}人\n评分范围：${l.ratingMin}-${l.ratingMax}分`,showCancel:!1})})(t)},{default:l((()=>[m(e,{class:"rating-btn-icon"},{default:l((()=>[f("📊")])),_:1}),m(e,{class:"rating-btn-text"},{default:l((()=>[f("详情")])),_:1})])),_:2},1032,["style","onClick"])])),_:2},1024)])),_:2},1024)):d("",!0),a.comments&&0!==a.comments.length?(u(),o(c,{key:5,class:"comments-section"},{default:l((()=>[(u(!0),v(b,null,y(a.comments,((a,t)=>(u(),o(c,{class:s(["comment-item",{"new-comment":a.isNew}]),key:t},{default:l((()=>[m(r,{class:"comment-anon-icon",src:a.avatar||h(J)},null,8,["src"]),m(c,{class:"comment-content-wrapper"},{default:l((()=>[m(c,{class:"comment-text-line"},{default:l((()=>[m(e,{class:"comment-user",style:g({color:la.value.primaryColor})},{default:l((()=>[f(p(a.username)+"：",1)])),_:2},1032,["style"]),m(e,{class:"comment-content"},{default:l((()=>[f(p(a.content),1)])),_:2},1024)])),_:2},1024),a.images&&a.images.length>0?(u(),o(c,{key:0,class:"comment-images"},{default:l((()=>[(u(!0),v(b,null,y(a.images,((t,e)=>(u(),o(r,{key:e,src:t,mode:"aspectFill",class:"comment-image",onClick:e=>Ma(a.images,t)},null,8,["src","onClick"])))),128))])),_:2},1024)):d("",!0)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)):d("",!0)])),_:2},1024),m(c,{class:"more-btn",onClick:a=>{T({itemList:["举报","拉黑","不感兴趣"],success:a=>{const t=a.tapIndex;0===t?n({title:"已收到举报",icon:"none"}):1===t?n({title:"已拉黑该用户",icon:"none"}):2===t&&n({title:"将减少类似内容",icon:"none"})}})}},{default:l((()=>[f("⋯")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),ra.value?(u(),o(c,{key:2,class:"comment-popup",onClick:wa},{default:l((()=>[m(c,{class:"comment-box animated-popup",onClick:t[1]||(t[1]=_((()=>{}),["stop"]))},{default:l((()=>[m(c,{class:"comment-input-area"},{default:l((()=>[m(w,{class:"comment-input",modelValue:ua.value,"onUpdate:modelValue":t[0]||(t[0]=a=>ua.value=a),placeholder:"@匿名用户 说点什么...",focus:ra.value,onConfirm:_a},null,8,["modelValue","focus"]),ma.value.length>0?(u(),o(c,{key:0,class:"comment-images-preview"},{default:l((()=>[(u(!0),v(b,null,y(ma.value,((a,t)=>(u(),o(c,{class:"comment-preview-item",key:t},{default:l((()=>[m(r,{src:a,mode:"aspectFill",class:"comment-preview-img"},null,8,["src"]),m(e,{class:"comment-preview-delete",onClick:a=>{return e=t,void ma.value.splice(e,1);var e}},{default:l((()=>[f("✕")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})):d("",!0),m(c,{class:"toolbar"},{default:l((()=>[m(c,{class:"toolbar-left"},{default:l((()=>[m(c,{class:"toolbar-icon emoji-btn",style:g({borderColor:`${la.value.primaryColor}20`}),onClick:Ca},{default:l((()=>[m(e,{class:"icon-emoji"},{default:l((()=>[f("😊")])),_:1})])),_:1},8,["style"]),m(c,{class:"toolbar-icon image-btn",style:g({borderColor:`${la.value.primaryColor}30`,background:`${la.value.primaryColor}08`}),onClick:qa},{default:l((()=>[m(c,{class:"icon-wrapper"},{default:l((()=>[m(e,{class:"icon-camera"},{default:l((()=>[f("📸")])),_:1})])),_:1}),ma.value.length>0?(u(),o(e,{key:0,class:"icon-label",style:g({background:la.value.primary})},{default:l((()=>[f(p(ma.value.length),1)])),_:1},8,["style"])):d("",!0)])),_:1},8,["style"])])),_:1}),m(C,{class:s(["submit-btn",{active:ua.value.trim()||ma.value.length>0}]),style:g(ua.value.trim()||ma.value.length>0?{background:la.value.primary}:{}),onClick:_a},{default:l((()=>[f("发送")])),_:1},8,["class","style"])])),_:1})])),_:1}),ia.value?(u(),o(c,{key:0,class:"emoji-panel"},{default:l((()=>[m(q,{"scroll-y":"",class:"emoji-list"},{default:l((()=>[m(c,{class:"emoji-group"},{default:l((()=>[(u(),v(b,null,y(bt,((a,t)=>m(e,{key:t,class:"emoji-item",onClick:t=>(a=>{ua.value+=a})(a)},{default:l((()=>[f(p(a),1)])),_:2},1032,["onClick"]))),64))])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1})])),_:1})):d("",!0),$a.value?(u(),o(c,{key:3,class:"fireworks"},{default:l((()=>[(u(!0),v(b,null,y(Ea.value,(a=>(u(),o(c,{key:a.id,class:"fw",style:g({left:a.x+"%",top:a.y+"%"})},{default:l((()=>[(u(),v(b,null,y(12,(t=>m(c,{key:t,class:s(["fw-p","p"+t,a.theme])},null,8,["class"]))),64))])),_:2},1032,["style"])))),128))])),_:1})):d("",!0),za.value?(u(),o(c,{key:4,class:"blessing-text-wrapper",onClick:Qa},{default:l((()=>[m(c,{class:s(["blessing-text",{"text-zooming":Na.value}])},{default:l((()=>[(u(),v(b,null,y(Ya,((a,t)=>m(e,{class:"blessing-char",key:t,style:g({animationDelay:`${.2*t}s, ${.2*t+.6}s, ${.2*t+1}s, ${.2*t+1.5}s`})},{default:l((()=>[f(p(a),1)])),_:2},1032,["style"]))),64))])),_:1},8,["class"]),m(c,{class:"text-particles"},{default:l((()=>[(u(!0),v(b,null,y(Ha.value,(a=>(u(),o(c,{key:a.id,class:"text-particle",style:g({left:a.x+"%",top:a.y+"%",background:a.color,animationDelay:a.delay+"s","--random-x":a.randomX,"--random-y":a.randomY})},null,8,["style"])))),128))])),_:1})])),_:1})):d("",!0)])),_:1},8,["class"])}}},[["__scopeId","data-v-9bba0ef5"]]);export{N as default};
