import{b as a,a as e,w as l,d as s,i as t,p as c,r as n,q as u,o,u as d,v as i,f,x as r,y as _,t as p,j as m,g as v,h as y,F as g,n as k,D as b,e as h,s as x,z as C,A as w,E as S,G as $,l as F,I as j,m as E,C as I}from"./index-B1YqlGux.js";import{_ as L}from"./uni-rate.C2WeV8i5.js";import{o as q,r as D}from"./uni-app.es.B_bhRF7P.js";import{_ as T}from"./uni-popup.B5kC5TMt.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";const V=z({},[["render",function(c,n){const u=t;return a(),e(u,{class:"skeleton-card glass-effect"},{default:l((()=>[s(u,{class:"card-header"},{default:l((()=>[s(u,{class:"company-name skeleton-bg"}),s(u,{class:"rating-wrapper"},{default:l((()=>[s(u,{class:"rating skeleton-bg"})])),_:1})])),_:1}),s(u,{class:"card-content"},{default:l((()=>[s(u,{class:"cons-box skeleton-bg"})])),_:1}),s(u,{class:"card-footer"},{default:l((()=>[s(u,{class:"stats"},{default:l((()=>[s(u,{class:"stat-item skeleton-bg"}),s(u,{class:"stat-item skeleton-bg"}),s(u,{class:"date skeleton-bg"})])),_:1}),s(u,{class:"city-tag skeleton-bg"})])),_:1})])),_:1})}],["__scopeId","data-v-ecb1a65c"]]),P=z(c({__name:"index",setup(c){const z=n([]),P=n(""),R=n(null),A=n(1),B=n(!0),G=n(!1),H=n(""),M=n([]),N=n([]),U=n(""),Y=u().statusBarHeight,J=a=>{const e=new Date(a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},K=async(a=1,e=!1)=>{e||(G.value=!0);try{const{result:l}=await h.callFunction({name:"getCompanyList",data:{page:a,pageSize:10,keyword:P.value,city:H.value}});if(0===l.code){const s=l.data.map((a=>({...a,isExpanded:!1})));e?z.value=[...z.value,...s]:setTimeout((()=>{z.value=s,G.value=!1}),500),B.value=10===l.data.length,A.value=a}}catch(l){x({title:"è·å–æ•°æ®å¤±è´¥",icon:"none"}),G.value=!1}},O=()=>{z.value=[],A.value=1,B.value=!0,K(1)},Q=()=>{O()},W=()=>{P.value="",O()},X=()=>{C({url:"/pages/comment/add/add-review"})};o((()=>{d("hasShownDisclaimer")||R.value.open(),K()}));const Z=()=>{w("hasShownDisclaimer",!0),R.value.close()},aa=n(null),ea=()=>{aa.value.open()},la=()=>{aa.value.close()},sa=()=>{S({data:"962723968@qq.com",success:()=>{x({title:"é‚®ç®±å·²å¤åˆ¶",icon:"success"})}})};q((()=>{(async()=>{B.value&&!G.value&&await K(A.value+1,!0)})()})),o((()=>{K()}));const ta=()=>{$({itemList:M.value.map((a=>a.name)),success:async a=>{const e=M.value[a.tapIndex];U.value=e.name,await(async a=>{try{const{result:e}=await h.callFunction({name:"getCityList",data:{province:a}});0===e.code&&(N.value=e.data)}catch(e){x({title:"è·å–åŸå¸‚å¤±è´¥",icon:"none"})}})(e.code),$({itemList:N.value.map((a=>a.name)),success:a=>{H.value=N.value[a.tapIndex].name,O()}})}})};o((async()=>{await(async()=>{try{const{result:a}=await h.callFunction({name:"getCityList"});0===a.code&&(M.value=a.data)}catch(a){x({title:"è·å–çœä»½å¤±è´¥",icon:"none"})}})(),K()}));const ca=n(0),na=n(0),ua=n(0),oa=()=>{x({title:`æ€»è®¡ ${ca.value} æ¡ç‚¹è¯„`,icon:"none"})},da=()=>{x({title:`å·²æ”¶å½• ${na.value} å®¶ä¼ä¸š`,icon:"none"})},ia=()=>{x({title:`ä»Šæ—¥æ–°å¢ ${ua.value} æ¡ç‚¹è¯„`,icon:"none"})};o((async()=>{await(async()=>{try{const{result:a}=await h.callFunction({name:"getStatistics"});0===a.code&&(ca.value=a.data.totalReviews,na.value=a.data.totalCompanies,ua.value=a.data.todayReviews)}catch(a){console.error("è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:",a)}})()}));const fa=n("default"),ra=[{name:"default",label:"é»˜è®¤ç´«"},{name:"blue",label:"æ·±é‚ƒè“"},{name:"green",label:"è‡ªç„¶ç»¿"},{name:"red",label:"çƒ­æƒ…çº¢"}],_a=()=>{$({itemList:ra.map((a=>a.label)),success:a=>{var e;e=ra[a.tapIndex].name,fa.value=e,w("theme",e)}})};return o((()=>{const a=d("theme");a&&(fa.value=a)})),(c,n)=>{const u=F,o=t,d=j,h=E,x=D(i("uni-rate"),L),w=I,S=D(i("uni-popup"),T);return a(),e(o,{class:k(["container",`theme-${fa.value}`])},{default:l((()=>[s(o,{class:"nav-bar",style:r({paddingTop:_(Y)+"px"})},{default:l((()=>[s(o,{class:"nav-content"},{default:l((()=>[s(o,{class:"nav-left"},{default:l((()=>[s(u,{class:"app-title"},{default:l((()=>[f("äººäººç‚¹è¯„")])),_:1}),s(u,{class:"app-subtitle"},{default:l((()=>[f("åŒ¿ååŒ–ç‚¹è¯„ï¼Œé¿é›·æŒ‡å—")])),_:1})])),_:1}),s(o,{class:"nav-right"},{default:l((()=>[s(o,{class:"nav-btn",onClick:_a},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ¨")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),s(o,{class:"intro-section",style:r({marginTop:_(Y)+88+"rpx"})},{default:l((()=>[s(o,{class:"intro-cards"},{default:l((()=>[s(o,{class:"intro-card glass-effect",onClick:oa},{default:l((()=>[s(o,{class:"card-content"},{default:l((()=>[s(u,{class:"count"},{default:l((()=>[f(p(ca.value||"0"),1)])),_:1}),s(u,{class:"label"},{default:l((()=>[f("æ€»ç‚¹è¯„")])),_:1})])),_:1}),s(u,{class:"icon"},{default:l((()=>[f("ğŸ“")])),_:1})])),_:1}),s(o,{class:"intro-card glass-effect",onClick:da},{default:l((()=>[s(o,{class:"card-content"},{default:l((()=>[s(u,{class:"count"},{default:l((()=>[f(p(na.value||"0"),1)])),_:1}),s(u,{class:"label"},{default:l((()=>[f("å·²æ”¶å½•")])),_:1})])),_:1}),s(u,{class:"icon"},{default:l((()=>[f("ğŸ¢")])),_:1})])),_:1}),s(o,{class:"intro-card glass-effect",onClick:ia},{default:l((()=>[s(o,{class:"card-content"},{default:l((()=>[s(u,{class:"count"},{default:l((()=>[f(p(ua.value||"0"),1)])),_:1}),s(u,{class:"label"},{default:l((()=>[f("ä»Šæ—¥æ–°å¢")])),_:1})])),_:1}),s(u,{class:"icon"},{default:l((()=>[f("ğŸ”¥")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),s(o,{class:"search-section",style:r({marginTop:_(Y)+"rpx"})},{default:l((()=>[s(o,{class:"search-wrapper glass-effect"},{default:l((()=>[s(o,{class:"search-input-box"},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ”")])),_:1}),s(d,{class:"input",modelValue:P.value,"onUpdate:modelValue":n[0]||(n[0]=a=>P.value=a),placeholder:"æœç´¢ç‚¹è¯„æ ‡é¢˜","placeholder-class":"placeholder","confirm-type":"search",onConfirm:Q},null,8,["modelValue"]),P.value?(a(),e(u,{key:0,class:"clear-icon",onClick:W},{default:l((()=>[f("âœ•")])),_:1})):m("",!0)])),_:1}),s(o,{class:"divider"}),s(o,{class:"location-picker",onClick:ta},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ“")])),_:1}),s(u,{class:"location-text"},{default:l((()=>[f(p(H.value||"é€‰æ‹©åŸå¸‚"),1)])),_:1}),s(u,{class:"icon-arrow"},{default:l((()=>[f("â–¼")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),G.value?(a(),v(g,{key:0},y(5,(a=>s(V,{key:a}))),64)):m("",!0),s(o,{class:k(["company-list",{"fade-in":!G.value}])},{default:l((()=>[G.value?(a(),v(g,{key:0},[],64)):0===z.value.length?(a(),e(o,{key:1,class:"empty-state"},{default:l((()=>[s(h,{class:"empty-image",src:"./static/images/empty.png",mode:"aspectFit"}),s(u,{class:"empty-text"},{default:l((()=>[f("æš‚æ— æ•°æ®")])),_:1}),s(u,{class:"empty-tips"},{default:l((()=>[f("å¿«æ¥æ·»åŠ ç¬¬ä¸€æ¡è¯„ä»·å§")])),_:1}),s(o,{class:"empty-btn",onClick:X},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("âœï¸")])),_:1}),s(u,{class:"text"},{default:l((()=>[f("å†™ç‚¹è¯„")])),_:1})])),_:1})])),_:1})):(a(!0),v(g,{key:2},y(z.value,((t,c)=>(a(),e(o,{key:t._id,class:"company-card glass-effect",style:r({"--index":c}),"hover-class":"company-card-hover",onClick:a=>{return e=t._id,void C({url:`/pages/comment/detail/detail?id=${e}`});var e}},{default:l((()=>[s(o,{class:"card-header"},{default:l((()=>[s(u,{class:"company-name"},{default:l((()=>[f(p(t.companyName),1)])),_:2},1024),s(o,{class:"rating-wrapper"},{default:l((()=>[s(x,{value:t.rating,size:"15"},null,8,["value"]),s(u,{class:"rating-text"},{default:l((()=>[f(p(t.rating||0),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),s(o,{class:"card-content"},{default:l((()=>[t.cons?(a(),e(o,{key:0,class:"cons-box"},{default:l((()=>{return[s(u,{class:k(["cons-text",{truncated:!t.isExpanded}])},{default:l((()=>[f(p(t.cons),1)])),_:2},1032,["class"]),(c=t.cons,c.length>100?(a(),e(u,{key:0,class:"expand-btn",onClick:b((a=>(a=>{a.isExpanded=!a.isExpanded})(t)),["stop"])},{default:l((()=>[f(p(t.isExpanded?"æ”¶èµ·":"æŸ¥çœ‹æ›´å¤š"),1)])),_:2},1032,["onClick"])):m("",!0))];var c})),_:2},1024)):m("",!0)])),_:2},1024),s(o,{class:"card-footer"},{default:l((()=>[s(o,{class:"stats"},{default:l((()=>[s(o,{class:"stat-item"},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ‘ï¸")])),_:1}),s(u,{class:"count"},{default:l((()=>[f(p(t.viewCount||0),1)])),_:2},1024)])),_:2},1024),s(o,{class:"stat-item"},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ’¬")])),_:1}),s(u,{class:"count"},{default:l((()=>[f(p(t.reviewCount||0),1)])),_:2},1024)])),_:2},1024),s(u,{class:"date"},{default:l((()=>[f(p(J(t.createTime)),1)])),_:2},1024)])),_:2},1024),s(u,{class:"city-tag"},{default:l((()=>[f(p(t.city),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1},8,["class"]),s(o,{class:"float-btns"},{default:l((()=>[s(o,{class:"float-btn glass-effect complaint-btn",onClick:ea},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ“¢")])),_:1})])),_:1}),s(o,{class:"float-btn glass-effect",onClick:X},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("âœï¸")])),_:1})])),_:1})])),_:1}),s(S,{ref_key:"disclaimerPopup",ref:R,type:"center"},{default:l((()=>[s(o,{class:"disclaimer-popup"},{default:l((()=>[s(o,{class:"popup-header"},{default:l((()=>[s(u,{class:"title"},{default:l((()=>[f("å…è´£å£°æ˜")])),_:1})])),_:1}),s(o,{class:"popup-content"},{default:l((()=>[s(u,{class:"text"},{default:l((()=>[f("1. æœ¬å¹³å°ä»…æä¾›ä¿¡æ¯åˆ†äº«æœåŠ¡ï¼Œæ‰€æœ‰å†…å®¹å‡æ¥è‡ªç”¨æˆ·å‘å¸ƒã€‚")])),_:1}),s(u,{class:"text"},{default:l((()=>[f("2. ç”¨æˆ·å‘å¸ƒçš„å†…å®¹ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œè¯·ç†æ€§å¯¹å¾…ã€‚")])),_:1}),s(u,{class:"text"},{default:l((()=>[f("3. å¦‚å‘ç°è¿è§„å†…å®¹ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬å¤„ç†ã€‚")])),_:1}),s(u,{class:"text"},{default:l((()=>[f("4. å¹³å°ä¿ç•™å¯¹è¿è§„å†…å®¹çš„å¤„ç†æƒåˆ©ã€‚")])),_:1})])),_:1}),s(o,{class:"popup-footer"},{default:l((()=>[s(w,{class:"confirm-btn",onClick:Z},{default:l((()=>[f("æˆ‘å·²äº†è§£")])),_:1})])),_:1})])),_:1})])),_:1},512),z.value.length>0?(a(),e(o,{key:1,class:"load-more"},{default:l((()=>[G.value?(a(),e(o,{key:0,class:"loading"},{default:l((()=>[s(o,{class:"loading-icon"}),s(u,{class:"loading-text"},{default:l((()=>[f("åŠ è½½ä¸­...")])),_:1})])),_:1})):B.value?m("",!0):(a(),e(u,{key:1,class:"no-more"},{default:l((()=>[f("æ²¡æœ‰å¤šäº†")])),_:1}))])),_:1})):m("",!0),s(S,{ref_key:"complaintPopup",ref:aa,type:"center"},{default:l((()=>[s(o,{class:"complaint-popup glass-effect"},{default:l((()=>[s(o,{class:"popup-header"},{default:l((()=>[s(u,{class:"title"},{default:l((()=>[f("æŠ•è¯‰å»ºè®®")])),_:1}),s(u,{class:"close-icon",onClick:la},{default:l((()=>[f("âœ•")])),_:1})])),_:1}),s(o,{class:"popup-content"},{default:l((()=>[s(o,{class:"content-item"},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("ğŸ“§")])),_:1}),s(o,{class:"item-info"},{default:l((()=>[s(u,{class:"label"},{default:l((()=>[f("é‚®ç®±è”ç³»")])),_:1}),s(u,{class:"value"},{default:l((()=>[f("962723968@qq.com")])),_:1})])),_:1}),s(w,{class:"copy-btn",onClick:sa},{default:l((()=>[f("å¤åˆ¶")])),_:1})])),_:1}),s(o,{class:"content-item"},{default:l((()=>[s(u,{class:"icon"},{default:l((()=>[f("âš ï¸")])),_:1}),s(o,{class:"item-info"},{default:l((()=>[s(u,{class:"label"},{default:l((()=>[f("æ¸©é¦¨æç¤º")])),_:1}),s(u,{class:"desc"},{default:l((()=>[f("å¦‚å‘ç°ä»»ä½•è¿è§„æˆ–ä¸å½“å†…å®¹ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬å¤„ç†ï¼Œæˆ‘ä»¬ä¼šåœ¨24å°æ—¶å†…ç»™äºˆå›å¤ã€‚")])),_:1})])),_:1})])),_:1})])),_:1}),s(o,{class:"popup-footer"},{default:l((()=>[s(w,{class:"confirm-btn",onClick:la},{default:l((()=>[f("æˆ‘çŸ¥é“äº†")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1},8,["class"])}}}),[["__scopeId","data-v-a498a9b9"]]);export{P as default};
