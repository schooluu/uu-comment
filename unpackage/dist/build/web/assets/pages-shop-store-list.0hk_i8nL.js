import{r as s,o as e,e as a,w as t,ar as l,a3 as u,x as o,c,f as d,h as i,t as r,i as n,j as f,k as _,F as m,B as g,A as p,m as v,v as h,I as b,S as k,y as x,z as y,as as C,s as T,W as I}from"./index-D7ax0EFp.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=j({__name:"list",setup(j){const w=s(""),F=s("正在定位..."),B=["全部门店","距离最近","评分最高","新开门店"],H=s(0),L=s(!1),W=s(!1),$=s([{id:1,name:"喜茶北京三里屯店",image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",distance:.8,address:"北京市朝阳区三里屯太古里北区N8-B1-3",features:["可预约","WIFI","礼品卡","室内停车"],status:"open",statusText:"营业中",businessHours:"10:00-22:00",latitude:39.934,longitude:116.455},{id:1,name:"喜茶北京三里屯店",image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",distance:.8,address:"北京市朝阳区三里屯太古里北区N8-B1-3",features:["可预约","WIFI","礼品卡","室内停车"],status:"open",statusText:"营业中",businessHours:"10:00-22:00",latitude:39.934,longitude:116.455},{id:1,name:"喜茶北京三里屯店",image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",distance:.8,address:"北京市朝阳区三里屯太古里北区N8-B1-3",features:["可预约","WIFI","礼品卡","室内停车"],status:"open",statusText:"营业中",businessHours:"10:00-22:00",latitude:39.934,longitude:116.455}]),q=()=>{l({type:"gcj02",success:s=>{u({url:`https://api.map.baidu.com/reverse_geocoding/v3/?ak=YOUR_KEY&location=${s.latitude},${s.longitude}`,success:s=>{F.value=s.data.result.address_component.street}})},fail:()=>{F.value="定位失败"}})},N=()=>{F.value="定位中...",q(),E()},V=()=>{if(!w.value.trim())return void U();const s=w.value.toLowerCase();$.value=$.value.filter((e=>e.name.toLowerCase().includes(s)||e.address.toLowerCase().includes(s)))},P=s=>{event.stopPropagation(),"closed"!==s.status?"busy"!==s.status?(s=>{v({url:`/pages/shop/store/goodsList?id=${s.id}`})})(s):I({title:"门店忙碌提醒",content:"当前门店较为繁忙，可能需要较长等待时间，是否继续下单？",confirmText:"继续下单",cancelText:"换个门店",success:s=>{s.confirm}}):T({title:"门店已打烊，请明天再来",icon:"none",duration:2e3})},R=async()=>{L.value=!0,setTimeout((()=>{L.value=!1}),1e3)},S=()=>{W.value||(W.value=!0,setTimeout((()=>{W.value=!1}),1e3))},U=()=>{W.value=!0,setTimeout((()=>{W.value=!1}),500)},Y=()=>{$.value.sort(((s,e)=>s.distance-e.distance))},z=()=>{$.value.sort(((s,e)=>e.rating-s.rating))},A=()=>{W.value=!0,setTimeout((()=>{$.value=[],W.value=!1}),500)},E=()=>{W.value=!0,setTimeout((()=>{$.value=[],W.value=!1}),500)};return e((()=>{q(),U()})),(s,e)=>{const l=h,u=b,T=o,I=k,j=x,q=y;return c(),a(T,{class:"store-container"},{default:t((()=>[d(T,{class:"search-bar glass-effect"},{default:t((()=>[d(T,{class:"search-input"},{default:t((()=>[d(l,{class:"search-icon"},{default:t((()=>[i("🔍")])),_:1}),d(u,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),placeholder:"搜索门店名称或地址",onInput:V},null,8,["modelValue"])])),_:1}),d(T,{class:"location",onClick:N},{default:t((()=>[d(l,{class:"location-icon"},{default:t((()=>[i("📍")])),_:1}),d(l,{class:"location-text"},{default:t((()=>[i(r(F.value),1)])),_:1})])),_:1})])),_:1}),d(I,{class:"filter-scroll glass-effect","scroll-x":"","show-scrollbar":!1,enhanced:""},{default:t((()=>[d(T,{class:"filter-list"},{default:t((()=>[(c(),n(m,null,f(B,((e,a)=>d(T,{class:_(["filter-item",{active:H.value===a}]),key:a,onClick:s=>(s=>{if(H.value!==s)switch(H.value=s,s){case 0:U();break;case 1:Y();break;case 2:z();break;case 3:A()}})(a)},{default:t((()=>[d(l,{class:"filter-icon"},{default:t((()=>[i(r(s.filterIcons[a]),1)])),_:2},1024),d(l,{class:"filter-text"},{default:t((()=>[i(r(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),d(I,{class:"store-list","scroll-y":"",onScrolltolower:S,"refresher-enabled":"","refresher-triggered":L.value,onRefresherrefresh:R},{default:t((()=>[(c(!0),n(m,null,f($.value,(s=>(c(),a(T,{class:"store-card glass-effect",key:s.id,onClick:e=>(s=>{v({url:`/pages/shop/store/detail?id=${s.id}`})})(s)},{default:t((()=>[d(j,{src:s.image,mode:"aspectFill",class:"store-image"},null,8,["src"]),d(T,{class:"store-info"},{default:t((()=>[d(T,{class:"store-header"},{default:t((()=>[d(l,{class:"store-name"},{default:t((()=>[i(r(s.name),1)])),_:2},1024),d(T,{class:"distance-tag"},{default:t((()=>[d(l,{class:"distance"},{default:t((()=>[i(r(s.distance)+"km",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(T,{class:"store-address"},{default:t((()=>[d(l,{class:"address-text"},{default:t((()=>[i(r(s.address),1)])),_:2},1024),d(l,{class:"navigation-btn",onClick:g((e=>(s=>{event.stopPropagation(),C({latitude:s.latitude,longitude:s.longitude,name:s.name,address:s.address,scale:18})})(s)),["stop"])},{default:t((()=>[i("导航")])),_:2},1032,["onClick"])])),_:2},1024),d(T,{class:"store-features"},{default:t((()=>[(c(!0),n(m,null,f(s.features,((s,e)=>(c(),a(l,{class:"feature-tag",key:e},{default:t((()=>[i(r(s),1)])),_:2},1024)))),128))])),_:2},1024),d(T,{class:"store-status"},{default:t((()=>[d(T,{class:"status-info"},{default:t((()=>[d(T,{class:_(["status-badge",s.status])},{default:t((()=>[d(l,{class:"status-icon"},{default:t((()=>[i(r("open"===s.status?"🟢":"busy"===s.status?"🟡":"⚪️"),1)])),_:2},1024),d(l,{class:"status-text"},{default:t((()=>[i(r(s.statusText),1)])),_:2},1024)])),_:2},1032,["class"]),d(T,{class:"hours-info"},{default:t((()=>[d(l,{class:"hours-icon"},{default:t((()=>[i("🕐")])),_:1}),d(l,{class:"business-hours"},{default:t((()=>[i(r(s.businessHours),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(q,{class:_(["order-btn",{disabled:"closed"===s.status}]),onClick:g((e=>P(s)),["stop"])},{default:t((()=>[d(l,{class:"btn-icon"},{default:t((()=>[i(r("closed"===s.status?"🌙":"🛍️"),1)])),_:2},1024),d(l,{class:"btn-text"},{default:t((()=>[i(r("closed"===s.status?"已打烊":"去下单"),1)])),_:2},1024)])),_:2},1032,["class","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),W.value?(c(),a(T,{key:0,class:"loading-state"},{default:t((()=>[d(l,{class:"loading-text"},{default:t((()=>[i("加载中...")])),_:1})])),_:1})):p("",!0),0!==$.value.length||W.value?p("",!0):(c(),a(T,{key:1,class:"empty-state"},{default:t((()=>[d(l,{class:"empty-icon"},{default:t((()=>[i("🏪")])),_:1}),d(l,{class:"empty-text"},{default:t((()=>[i("暂无门店")])),_:1}),d(l,{class:"empty-desc"},{default:t((()=>[i("换个地址试试吧")])),_:1})])),_:1}))])),_:1},8,["refresher-triggered"])])),_:1})}}},[["__scopeId","data-v-629ea6a7"]]);export{w as default};
