import{r as a,o as e,e as t,w as l,k as s,l as o,s as c,a4 as n,x as i,c as u,f as r,h as d,t as m,A as f,u as p,n as h,i as v,j as _,F as g,B as k,m as y,q as b,D as w,H as x,J as C,W as M,v as T,y as j,P as I,Q as q,U as F,I as L,z as E,S,L as U}from"./index-LLmpo-Oa.js";import{a as V,b as $,c as A,o as P,d as D}from"./uni-app.es.B9qLl5yo.js";import{_ as J}from"./_plugin-vue_export-helper.BCo6x5W8.js";const Q=J({__name:"index",setup(J){const Q=["星河旅人","夏日微风","蓝莓汽水","橙子汽球","夜空守望","晨曦微光","云端漫步","月下独行","白茶清欢","青柠时光","温柔星球","晴空万里","风中诗人","海盐冰沙","山野听风","橘子海岸","银河信使","微光拾梦","晚风邮差","雾里看花","森林之心","雨后初晴","云朵收集者","夏夜萤火"];function H(){return Q[Math.floor(Math.random()*Q.length)]}const N=["https://qcloud.dpfile.com/pc/pawK4KeJSDNVINhfwh9CoLJPFluB-tnHSd3heJ_jybtNIYslSlGEPeQVyA4hZRCP.jpg","https://images.unsplash.com/photo-1502685104226-ee32379fefbe?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1527980965255-d3b416303d12?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=256&q=60"],R=N[Math.floor(Math.random()*N.length)],z=["https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1516822003754-cca485356ecb?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1544006659-f0b21884ce1d?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1542202229-7d93c33f5d07?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1519345182560-3f2917c472ef?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=1400&q=60","https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=1400&q=60"],B=z[Math.floor(Math.random()*z.length)],K=R,Y=["今天也要元气满满！","匿名分享，轻松自在~","每一天都值得记录。","用心感受生活的美好。","科技让匿名更温暖。","世界很大，心情很美。","做自己的小太阳 ☀️","匿名不孤单，温暖在身边。","记录此刻，遇见更好的自己。","保持好奇，保持热爱！"],G=Y[Math.floor(Math.random()*Y.length)],O=["匿名树洞 · 美好生活","用温柔治愈世界","每一天都值得记录","让心情自由流动","科技让温暖发生","在这里遇见美好","分享你的故事","做自己的小太阳","世界很大，温暖很近","用匿名守护真心"];a(O[0]);const W=a(""),Z=a(!0);let X=null,aa=0,ea=0;function ta(){clearTimeout(X);const a=O[aa];W.value="",ea=0,function e(){ea<=a.length?(W.value=a.slice(0,ea),ea++,X=setTimeout(e,60)):setTimeout((()=>{aa=(aa+1)%O.length,ta()}),1800)}()}e((()=>{ta(),setInterval((()=>{Z.value=!Z.value}),500),ve()}));const la=a(!1),sa=a(!1),oa=a(""),ca=a(-1),na=a({}),ia=a(1),ua=a(10),ra=a(!1),da=a(!0),ma=a([]),fa=async(a=!1)=>{if(!ra.value&&(da.value||a))try{ra.value=!0;const t=new Promise((a=>setTimeout(a,800))),[{result:l}]=await Promise.all([o.callFunction({name:"wx_get_list",data:{page:a?1:ia.value,pageSize:ua.value}}),t]);if(0!==l.code)throw new Error(l.msg);{const t=l.data.list.map((a=>({...a,username:H(),avatar:N[Math.floor(Math.random()*N.length)],comments:(a.comments||[]).map((a=>({...a,username:H(),avatar:N[Math.floor(Math.random()*N.length)]}))),likes:(a.likes||[]).map((()=>H()))})));if(a)ma.value=t,ia.value=2;else{const a=new Set((ma.value||[]).map((a=>a._id))),e=t.filter((e=>!a.has(e._id)));ma.value=[...ma.value||[],...e],ia.value++}da.value=l.data.hasMore;try{Ga()}catch(e){}}}catch(t){c({title:t.message||"获取朋友圈失败",icon:"none"})}finally{ra.value=!1,a&&n()}};V((()=>{fa(!0),La(),Fa(),setTimeout((()=>{fa(!0)}),33e3),re()})),$((()=>{La(),ce()})),A((()=>{La(),ce()})),P((()=>{!ra.value&&da.value&&fa()}));const pa=async()=>{if(oa.value.trim()){la.value=!1,sa.value=!1,c({title:"评论成功",icon:"none"});try{const{result:a}=await o.callFunction({name:"wx_add_comment",data:{momentId:ma.value[ca.value]._id,content:oa.value}});if(0!==a.code)throw new Error(a.msg);{const a=ma.value[ca.value];a.comments||(a.comments=[]),a.comments.push({username:H(),content:oa.value,create_time:Date.now()}),oa.value=""}}catch(a){c({title:a.message||"评论失败",icon:"none"})}}},ha=async()=>{y({url:"/pages/wx/home/add"})},va=()=>{la.value=!1,sa.value=!1,oa.value="",ca.value=-1},_a=()=>{sa.value=!sa.value},ga=()=>{c({title:"视频加载失败",icon:"none"})},ka=()=>{w({itemList:["切换主题","内容偏好","帮助与反馈"],success:a=>{const e=a.tapIndex;0===e&&c({title:"已切换主题",icon:"none"}),1===e&&c({title:"偏好设置暂未开放",icon:"none"}),2===e&&c({title:"感谢你的反馈",icon:"none"})}})},ya=a(0);D((a=>{const e=a.scrollTop||0;ya.value=Math.min(30,.2*e)}));const ba=a("theme-day"),wa=()=>{const a=(new Date).getHours();ba.value=a>=6&&a<11?"theme-morning":a>=11&&a<18?"theme-day":"theme-night"};e((()=>{wa(),setInterval(wa,6e5)}));const xa=a(!1),Ca=a([]);let Ma=0;const Ta=a=>{const e=Ca.value.findIndex((e=>e.id===a));-1!==e&&Ca.value.splice(e,1)},ja=(a=4,e=1e3)=>{xa.value=!0;const t=Math.max(1,a),l=Math.floor(e/t);for(let s=0;s<t;s++){setTimeout((()=>{const a=Ma++;Ca.value.push({id:a,x:Math.floor(10+80*Math.random()),y:Math.floor(18+54*Math.random()),theme:["t-blue","t-violet","t-gold","t-mint","t-pink"][Math.floor(5*Math.random())]}),setTimeout((()=>{Ta(a),0===Ca.value.length&&(xa.value=!1)}),2200)}),s*l)}},Ia=async a=>{try{const e=ma.value[a];na.value[a]=!0;const{result:t}=await o.callFunction({name:"wx_add_toggle_like",data:{momentId:e._id}});if(0!==t.code)throw new Error(t.msg);e.isLiked=t.data.isLiked,e.isLiked?(e.likes||(e.likes=[]),e.likes.push(H())):e.likes.pop(),setTimeout((()=>{na.value[a]=!1}),1e3)}catch(e){c({title:e.message||"操作失败",icon:"none"})}};let qa=null;const Fa=()=>{qa||(xa.value=!0,qa=setInterval((()=>{const a=3+Math.floor(3*Math.random()),e=1e3+Math.floor(600*Math.random());ja(a,e)}),1500+Math.floor(900*Math.random())))},La=()=>{clearInterval(qa),qa=null,xa.value=!1,Ca.value=[]},Ea=a=>a||0===a?a>=1e4?(a/1e4).toFixed(1).replace(/\.0$/,"")+"w":a>=1e3?(a/1e3).toFixed(1).replace(/\.0$/,"")+"k":String(a):"0",Sa=a=>{const e=a.likes&&a.likes.length||0,t=a.comments&&a.comments.length||0,l="video"===a.mediaType;return Math.floor(3*e+5*t+(l?18:8))};a("recommend");const Ua=a({}),Va=a([{tag:"# 精选",title:"今日热聊：匿名也要有态度",sub:"来一条走心的分享吧"},{tag:"# 新鲜",title:"你的小确幸，值得被看到",sub:"记录当下，温暖一整天"},{tag:"# 附近",title:"发现身边的美好瞬间",sub:"同城热点，马上加入"}]),$a=a=>{const e=Object.keys(a||{}).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(null==a[e]?"":a[e]))).join("&");y({url:"/pages/wx/photos/add"+(e?"?"+e:"")})},Aa=()=>{Za.value=!1,Xa.value=null,ae.value=0,ee.value="",te.value=-1},Pa=async()=>{if(0!==ae.value)try{x({title:"提交中..."});const{result:a}=await o.callFunction({name:"wx_add_rating",data:{momentId:Xa.value._id,rating:ae.value,comment:ee.value,ratingType:Xa.value.ratingType}});if(0!==a.code)throw new Error(a.msg);c({title:"评分成功",icon:"success"}),ma.value[te.value].ratingStats||(ma.value[te.value].ratingStats={average:0,count:0}),Aa()}catch(a){c({title:a.message||"评分失败",icon:"none"})}finally{C()}else c({title:"请选择评分",icon:"none"})},Da=a([{text:"# 今天你匿名表白了吗",views:"12.3w",posts:"2.1k",emoji:"💌",badge:"热议",badgeType:"badge-hot",cta:"参与"},{text:"# 城市树洞：你的小烦恼",views:"8.7w",posts:"1.2k",emoji:"🌆",badge:"同城",badgeType:"badge-near",cta:"去看看",mood:"氛围很暖"},{text:"# 三件让你快乐的小事",views:"6.5w",posts:"980",emoji:"✨",badge:"精选",badgeType:"badge-new",cta:"我也分享"}]),Ja=a=>{$a({text:a.text,views:a.views,posts:a.posts,emoji:a.emoji,badge:a.badge,badgeType:a.badgeType})},Qa=a(!1);let Ha=null;const Na=[];let Ra=Math.floor(Math.random()*Na.length);const za=()=>Na[Ra%Na.length],Ba=()=>"undefined"==typeof Audio?null:(Ha||(Ha=new Audio(za()),Ha.loop=!0,Ha.preload="auto",Ha.volume=.6,Ha.onerror=()=>{try{const a=(Ra=(Ra+1)%Na.length,za());Ha.src=a,Qa.value&&Ha.play().catch((()=>{Qa.value=!1,c({title:"背景音乐需手动播放",icon:"none"})}))}catch(a){}}),Ha),Ka=["today vibes","mood on","little joy","city walk","coffee o’clock","soft light","daily look","slow life"],Ya=a([]),Ga=()=>{const a=(()=>{const a=[];return(ma.value||[]).forEach((e=>{"image"===e.mediaType&&Array.isArray(e.mediaUrls)&&e.mediaUrls.forEach((e=>{e&&a.push({url:e})})),Array.isArray(e.mediaList)&&e.mediaList.filter((a=>a&&"image"===a.type&&a.url)).forEach((e=>a.push({url:e.url})))})),a})();if(!a.length)return void(Ya.value=[]);const e=a.sort((()=>Math.random()-.5)).slice(0,8);Ya.value=e.map((a=>({...a,likes:Math.floor(100+9e3*Math.random()),emoji:["💖","🌸","📸","😊","☕","👗","🧋","✨"][Math.floor(8*Math.random())],caption:Ka[Math.floor(Math.random()*Ka.length)]})))},Oa=()=>{Ga()},Wa=a=>({beauty:"颜值评分",style:"穿搭评分",photo:"照片评分"}[a]||"评分"),Za=a(!1),Xa=a(null),ae=a(0),ee=a(""),te=a(-1);V((()=>{setTimeout((()=>Ga()),400),se()})),$((()=>{oe()})),A((()=>{oe()}));let le=null;const se=()=>{le||(le=setInterval((()=>{Ga()}),5e3))},oe=()=>{le&&(clearInterval(le),le=null)},ce=()=>{if(Ha)try{Ha.pause()}catch(a){}Qa.value=!1},ne=()=>{const a=Ba();a&&(Qa.value?ce():a.play().then((()=>{Qa.value=!0})).catch((()=>{c({title:"需手动点击播放",icon:"none"})})))};let ie=!1;const ue=()=>{re()},re=()=>{const a=Ba();a&&(a.muted=!0,a.volume=0,a.play().then((()=>{Qa.value=!0,a.muted=!1,((a=.6,e=1200)=>{const t=Ha;if(!t)return;const l=t.volume||0,s=Math.max(1,Math.floor(e/80));let o=0;const c=setInterval((()=>{o++,t.volume=l+o/s*(a-l),o>=s&&clearInterval(c)}),80)})(.6,1200),"undefined"!=typeof document&&(["touchstart","click","wheel","keydown"].forEach((a=>{try{document.removeEventListener(a,ue)}catch(e){}})),ie=!1)})).catch((()=>{"undefined"==typeof document||ie||(["touchstart","click","wheel","keydown"].forEach((a=>{try{document.addEventListener(a,ue,{once:!0,passive:!0})}catch(e){}})),ie=!0)})))},de=["😊","😂","🤣","❤️","😍","🤔","😒","👍","👎","😳","🥺","😭","😘","🤗","🙄","😴","🤮","🤧","😷","🤒","🤕","😈","👻","👽","🤖","💩","😺","💪","👊","✌️","🤞","🙏","👏","🙌","👐","🤲"],me=a(!0),fe=a(30);let pe=null;const he=()=>{me.value=!1,pe&&(clearInterval(pe),pe=null)},ve=()=>{pe=setInterval((()=>{fe.value--,fe.value<=0&&he()}),1e3)},_e=async(a,e)=>{try{x({title:"处理中..."});const e=ma.value[a],{result:t}=await o.callFunction({name:"wx_del",data:{momentId:e._id}});if(0!==t.code)throw new Error(t.msg||"删除失败");ma.value.splice(a,1),C(),c({title:"举报已成功",icon:"none",duration:2e3})}catch(t){C(),c({title:t.message||"操作失败，请重试",icon:"none"})}};return(a,e)=>{const o=T,n=i,y=j,x=I,C=q,V=F,$=L,A=E,P=S,D=U;return u(),t(n,{class:s(["moments-container",ba.value,{"disclaimer-hidden":!me.value}])},{default:l((()=>[me.value?(u(),t(n,{key:0,class:"disclaimer-banner"},{default:l((()=>[r(n,{class:"disclaimer-banner-content"},{default:l((()=>[r(n,{class:"disclaimer-banner-left"},{default:l((()=>[r(o,{class:"disclaimer-banner-icon"},{default:l((()=>[d("⚠️")])),_:1}),r(o,{class:"disclaimer-banner-text"},{default:l((()=>[d(" 本网站仅供编程学习交流使用，非商业网站，所有内容均为学习演示，真实性无法保证。请理性对待，切勿轻信。严禁发布违法违规内容，用户需对发布内容负责。 ")])),_:1})])),_:1}),r(n,{class:"disclaimer-banner-right"},{default:l((()=>[r(o,{class:"disclaimer-banner-timer"},{default:l((()=>[d(m(fe.value)+"s",1)])),_:1}),r(o,{class:"disclaimer-banner-close",onClick:he},{default:l((()=>[d("✕")])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0),r(n,{class:"header"},{default:l((()=>[r(y,{class:"bg-image",src:p(B),mode:"aspectFill",style:h({transform:`translateY(${ya.value}px) scale(1.06)`})},null,8,["src","style"]),r(n,{class:"header-gradient"}),r(n,{class:"header-blur"}),r(n,{class:"header-glow"}),r(n,{class:"header-topbar"},{default:l((()=>[r(o,{class:"brand"},{default:l((()=>[d("匿名圈")])),_:1}),r(n,{class:"top-actions"},{default:l((()=>[r(o,{class:"top-icon",onClick:ka},{default:l((()=>[d("⋯")])),_:1})])),_:1})])),_:1}),r(n,{class:"hero-card"},{default:l((()=>[r(y,{class:"hero-avatar",src:p(K),mode:"aspectFill"},null,8,["src"]),r(n,{class:"hero-text"},{default:l((()=>[r(o,{class:"hero-title"},{default:l((()=>[d(m(p(G)),1)])),_:1}),r(o,{class:"hero-sub"},{default:l((()=>[d("匿名 · 温暖 · 真实")])),_:1}),r(n,{class:"hero-chips"},{default:l((()=>[r(o,{class:"chip active"},{default:l((()=>[d("推荐")])),_:1}),r(o,{class:"chip"},{default:l((()=>[d("关注")])),_:1}),r(o,{class:"chip"},{default:l((()=>[d("附近")])),_:1})])),_:1})])),_:1}),r(n,{class:"hero-cta",onClick:ha},{default:l((()=>[r(y,{class:"cta-icon",src:"https://img.icons8.com/fluency/48/plus.png",mode:"aspectFit"})])),_:1})])),_:1})])),_:1}),Ya.value.length?(u(),t(n,{key:1,class:"photo-showcase"},{default:l((()=>[r(n,{class:"ps-header"},{default:l((()=>[r(o,{class:"ps-title"},{default:l((()=>[d("最美照片")])),_:1}),r(o,{class:"ps-action",onClick:Oa},{default:l((()=>[d("换一换")])),_:1})])),_:1}),r(n,{class:"ps-row"},{default:l((()=>[(u(!0),v(g,null,_(Ya.value,((a,e)=>(u(),t(n,{class:"ps-item",key:e,onClick:a=>(a=>{const e=Ya.value.map((a=>a.url));b({urls:e,current:e[a]})})(e)},{default:l((()=>[r(y,{class:"ps-img",src:a.url,mode:"aspectFill"},null,8,["src"]),r(n,{class:"ps-overlay"},{default:l((()=>[r(n,{class:"ps-cap"},{default:l((()=>[r(o,{class:"ps-emoji"},{default:l((()=>[d(m(a.emoji),1)])),_:2},1024),r(o,{class:"ps-text"},{default:l((()=>[d(m(a.caption),1)])),_:2},1024)])),_:2},1024),r(o,{class:"ps-like"},{default:l((()=>[d("❤ "+m(Ea(a.likes)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):f("",!0),r(n,{class:"banner-topics"},{default:l((()=>[r(C,{class:"banner-swiper",circular:"",autoplay:"",interval:"4000"},{default:l((()=>[(u(!0),v(g,null,_(Va.value,((a,e)=>(u(),t(x,{key:e},{default:l((()=>[r(n,{class:"topic-card",onClick:e=>(a=>{$a({tag:a.tag,title:a.title,sub:a.sub})})(a)},{default:l((()=>[r(n,{class:"topic-tag"},{default:l((()=>[d(m(a.tag),1)])),_:2},1024),r(o,{class:"topic-title"},{default:l((()=>[d(m(a.title),1)])),_:2},1024),r(o,{class:"topic-sub"},{default:l((()=>[d(m(a.sub),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}),r(n,{class:"hot-board"},{default:l((()=>[r(n,{class:"hot-title"},{default:l((()=>[d("今日热榜")])),_:1}),r(n,{class:"hot-list"},{default:l((()=>[(u(!0),v(g,null,_(Da.value,((a,e)=>(u(),t(n,{class:"hot-item",key:e,onClick:e=>Ja(a)},{default:l((()=>[r(o,{class:s(["hot-rank",{top:e<3}])},{default:l((()=>[d(m(e+1),1)])),_:2},1032,["class"]),r(n,{class:"hot-thumb"},{default:l((()=>[a.thumb?(u(),t(y,{key:0,class:"hot-thumb-img",src:a.thumb,mode:"aspectFill"},null,8,["src"])):(u(),t(o,{key:1,class:"hot-thumb-emoji"},{default:l((()=>[d(m(a.emoji),1)])),_:2},1024))])),_:2},1024),r(n,{class:"hot-content"},{default:l((()=>[r(n,{class:"hot-row"},{default:l((()=>[r(o,{class:"hot-text"},{default:l((()=>[d(m(a.text),1)])),_:2},1024),a.badge?(u(),t(o,{key:0,class:s(["hot-badge",a.badgeType||"badge-hot"])},{default:l((()=>[d(m(a.badge),1)])),_:2},1032,["class"])):f("",!0)])),_:2},1024),r(o,{class:"hot-meta"},{default:l((()=>[d(m(a.views)+" 次浏览 · "+m(a.posts)+" 条讨论 · "+m(a.mood||"讨论正热"),1)])),_:2},1024)])),_:2},1024),r(n,{class:"hot-cta",onClick:k((e=>Ja(a)),["stop"])},{default:l((()=>[d(m(a.cta||"去看看"),1)])),_:2},1032,["onClick"]),r(o,{class:"hot-arrow"},{default:l((()=>[d("›")])),_:1})])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),r(n,{class:"moments-list"},{default:l((()=>[(u(!0),v(g,null,_(ma.value,((a,e)=>(u(),t(n,{class:"moment-item",key:e},{default:l((()=>[r(y,{class:"user-avatar avatar-glow",src:a.avatar,mode:"aspectFill"},null,8,["src"]),r(n,{class:"content-area"},{default:l((()=>[r(n,{class:"meta-row"},{default:l((()=>[r(o,{class:"username"},{default:l((()=>[d(m(a.username),1)])),_:2},1024)])),_:2},1024),r(n,{class:"chip-row"},{default:l((()=>[r(o,{class:"chip"},{default:l((()=>[d("匿名")])),_:1}),a.mediaType?(u(),t(o,{key:0,class:"chip ghost"},{default:l((()=>[d("图文")])),_:1})):f("",!0)])),_:2},1024),r(n,{class:s(["text-block",{clamped:!Ua.value[e]}])},{default:l((()=>[r(o,{class:"text-content"},{default:l((()=>[d(m(a.content),1)])),_:2},1024)])),_:2},1032,["class"]),a.content&&a.content.length>60?(u(),t(n,{key:0,class:"expand-btn",onClick:a=>(a=>{Ua.value[a]=!Ua.value[a]})(e)},{default:l((()=>[d(m(Ua.value[e]?"收起":"展开"),1)])),_:2},1032,["onClick"])):f("",!0),a.mediaType?(u(),t(n,{key:1,class:"media-content"},{default:l((()=>["video"===a.mediaType?(u(),t(V,{key:0,src:a.mediaUrl,poster:a.poster,class:"video-content video-radius",controls:"","show-center-play-btn":"","enable-play-gesture":"","show-fullscreen-btn":"","show-play-btn":"","object-fit":"contain",onError:ga},null,8,["src","poster"])):"image"===a.mediaType?(u(),t(n,{key:1,class:s(["image-gallery",`columns-${a.mediaUrls.length}`])},{default:l((()=>[(u(!0),v(g,null,_(a.mediaUrls,((e,l)=>(u(),t(y,{key:l,src:e,mode:"aspectFill",class:"image-content image-radius",onClick:t=>{return l=a.mediaUrls,s=e,void(l&&l.length&&b({urls:l,current:s}));var l,s}},null,8,["src","onClick"])))),128))])),_:2},1032,["class"])):f("",!0),r(n,{class:"media-badges"},{default:l((()=>[r(n,{class:"badge ghost"},{default:l((()=>[r(o,{class:"b-ic"},{default:l((()=>[d("🔥")])),_:1}),r(o,{class:"b-txt"},{default:l((()=>[d(m(Ea(Sa(a))),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)):f("",!0),r(n,{class:"bottom-info"},{default:l((()=>[r(o,{class:"time"},{default:l((()=>[d(m(a.time),1)])),_:2},1024),r(n,{class:"actions"},{default:l((()=>[r(n,{class:s(["action-btn like-btn",{liked:a.isLiked,animating:na.value[e]}]),onClick:a=>(async a=>{await Ia(a),ja(3)})(e)},{default:l((()=>[r(o,{class:"icon iconfont"},{default:l((()=>[d(m(a.isLiked?"❤️":"🤍"),1)])),_:2},1024),r(o,{class:"action-text"},{default:l((()=>[d(m(a.isLiked?"已赞":"点赞"),1)])),_:2},1024),r(o,{class:"action-count"},{default:l((()=>[d(m(a.likes&&a.likes.length||0),1)])),_:2},1024),na.value[e]?(u(),t(n,{key:0,class:"like-burst-particles"},{default:l((()=>[(u(),v(g,null,_(8,(a=>r(n,{key:a,class:s(["particle","p"+a])},null,8,["class"]))),64))])),_:1})):f("",!0)])),_:2},1032,["class","onClick"]),r(n,{class:"action-btn comment-btn",onClick:a=>(a=>{ca.value=a,la.value=!0})(e)},{default:l((()=>[r(o,{class:"icon iconfont"},{default:l((()=>[d("💬")])),_:1}),r(o,{class:"action-text"},{default:l((()=>[d("评论")])),_:1}),r(o,{class:"action-count"},{default:l((()=>[d(m(a.comments&&a.comments.length||0),1)])),_:2},1024)])),_:2},1032,["onClick"]),r(n,{class:"action-btn report-btn",onClick:a=>(a=>{ma.value[a],w({title:"举报内容",itemList:["色情低俗","暴力血腥","政治敏感","诈骗信息","垃圾广告","其他违规"],success:e=>{const t=["色情低俗","暴力血腥","政治敏感","诈骗信息","垃圾广告","其他违规"][e.tapIndex];M({title:"确认举报",content:`确定要举报此内容为"${t}"吗？`,success:e=>{e.confirm&&_e(a)}})}})})(e)},{default:l((()=>[r(o,{class:"icon iconfont"},{default:l((()=>[d("🚨")])),_:1}),r(o,{class:"action-text"},{default:l((()=>[d("举报")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),a.likes&&a.likes.length?(u(),t(n,{key:2,class:"likes-section"},{default:l((()=>[r(o,{class:"like-users"},{default:l((()=>[d(m(a.likes.join("、")),1)])),_:2},1024)])),_:2},1024)):f("",!0),a.contactValue?(u(),t(n,{key:3,class:"contact-section"},{default:l((()=>[r(o,{class:"contact-icon"},{default:l((()=>[d("📞")])),_:1}),r(o,{class:"contact-text"},{default:l((()=>{return[d(m((e=a.contactType,{wechat:"微信",phone:"手机",qq:"QQ",email:"邮箱"}[e]||"联系"))+"："+m(a.contactValue),1)];var e})),_:2},1024)])),_:2},1024)):f("",!0),a.ratingType?(u(),t(n,{key:4,class:"rating-section"},{default:l((()=>[r(n,{class:"rating-header"},{default:l((()=>[r(o,{class:"rating-icon"},{default:l((()=>[d("⭐")])),_:1}),r(o,{class:"rating-title"},{default:l((()=>[d(m(Wa(a.ratingType)),1)])),_:2},1024),r(o,{class:"rating-range"},{default:l((()=>[d("("+m(a.ratingMin)+"-"+m(a.ratingMax)+"分)",1)])),_:2},1024)])),_:2},1024),a.ratingStats?(u(),t(n,{key:0,class:"rating-stats"},{default:l((()=>[r(n,{class:"rating-avg"},{default:l((()=>[r(o,{class:"avg-score"},{default:l((()=>[d(m(a.ratingStats.average.toFixed(1)),1)])),_:2},1024),r(o,{class:"avg-label"},{default:l((()=>[d("平均分")])),_:1})])),_:2},1024),r(n,{class:"rating-count"},{default:l((()=>[r(o,{class:"count-num"},{default:l((()=>[d(m(a.ratingStats.count),1)])),_:2},1024),r(o,{class:"count-label"},{default:l((()=>[d("人评分")])),_:1})])),_:2},1024)])),_:2},1024)):f("",!0),r(n,{class:"rating-actions"},{default:l((()=>[r(n,{class:"rating-btn",onClick:a=>(a=>{te.value=a,Xa.value=ma.value[a],ae.value=0,ee.value="",Za.value=!0})(e)},{default:l((()=>[r(o,{class:"rating-btn-icon"},{default:l((()=>[d("⭐")])),_:1}),r(o,{class:"rating-btn-text"},{default:l((()=>[d("评分")])),_:1})])),_:2},1032,["onClick"]),r(n,{class:"rating-btn",onClick:a=>(a=>{var e,t,l;const s=ma.value[a];M({title:`${Wa(s.ratingType)}详情`,content:`平均分：${(null==(t=null==(e=s.ratingStats)?void 0:e.average)?void 0:t.toFixed(1))||0}分\n评分人数：${(null==(l=s.ratingStats)?void 0:l.count)||0}人\n评分范围：${s.ratingMin}-${s.ratingMax}分`,showCancel:!1})})(e)},{default:l((()=>[r(o,{class:"rating-btn-icon"},{default:l((()=>[d("📊")])),_:1}),r(o,{class:"rating-btn-text"},{default:l((()=>[d("详情")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):f("",!0),a.comments&&0!==a.comments.length?(u(),t(n,{key:5,class:"comments-section"},{default:l((()=>[(u(!0),v(g,null,_(a.comments,((a,e)=>(u(),t(n,{class:"comment-item",key:e},{default:l((()=>[r(y,{class:"comment-anon-icon",src:a.avatar||p(R)},null,8,["src"]),r(o,{class:"comment-user"},{default:l((()=>[d(m(a.username)+"：",1)])),_:2},1024),r(o,{class:"comment-content"},{default:l((()=>[d(m(a.content),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)):f("",!0)])),_:2},1024),r(n,{class:"more-btn",onClick:a=>{w({itemList:["举报","拉黑","不感兴趣"],success:a=>{const e=a.tapIndex;0===e?c({title:"已收到举报",icon:"none"}):1===e?c({title:"已拉黑该用户",icon:"none"}):2===e&&c({title:"将减少类似内容",icon:"none"})}})}},{default:l((()=>[d("⋯")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),la.value?(u(),t(n,{key:2,class:"comment-popup",onClick:va},{default:l((()=>[r(n,{class:"comment-box animated-popup",onClick:e[1]||(e[1]=k((()=>{}),["stop"]))},{default:l((()=>[r(n,{class:"comment-input-area"},{default:l((()=>[r($,{class:"comment-input",modelValue:oa.value,"onUpdate:modelValue":e[0]||(e[0]=a=>oa.value=a),placeholder:"@匿名用户 说点什么...",focus:la.value,onConfirm:pa},null,8,["modelValue","focus"]),r(n,{class:"toolbar"},{default:l((()=>[r(o,{class:"emoji-btn",onClick:_a},{default:l((()=>[d("😊")])),_:1}),r(A,{class:s(["submit-btn",{active:oa.value.trim()}]),onClick:pa},{default:l((()=>[d("发送")])),_:1},8,["class"])])),_:1})])),_:1}),sa.value?(u(),t(n,{key:0,class:"emoji-panel"},{default:l((()=>[r(P,{"scroll-y":"",class:"emoji-list"},{default:l((()=>[r(n,{class:"emoji-group"},{default:l((()=>[(u(),v(g,null,_(de,((a,e)=>r(o,{key:e,class:"emoji-item",onClick:e=>(a=>{oa.value+=a})(a)},{default:l((()=>[d(m(a),1)])),_:2},1032,["onClick"]))),64))])),_:1})])),_:1})])),_:1})):f("",!0)])),_:1})])),_:1})):f("",!0),Za.value?(u(),t(n,{key:3,class:"rating-popup",onClick:Aa},{default:l((()=>[r(n,{class:"rating-box animated-popup",onClick:e[3]||(e[3]=k((()=>{}),["stop"]))},{default:l((()=>[r(n,{class:"rating-header"},{default:l((()=>[r(o,{class:"rating-title"},{default:l((()=>{var a;return[d(m(Wa(null==(a=Xa.value)?void 0:a.ratingType)),1)]})),_:1}),r(o,{class:"rating-close",onClick:Aa},{default:l((()=>[d("✕")])),_:1})])),_:1}),r(n,{class:"rating-content"},{default:l((()=>[r(n,{class:"rating-stars"},{default:l((()=>[(u(),v(g,null,_(10,(a=>r(o,{key:a,class:s(["star",{active:a<=ae.value}]),onClick:e=>{return t=a,void(ae.value=t);var t}},{default:l((()=>[d("⭐")])),_:2},1032,["class","onClick"]))),64))])),_:1}),r(n,{class:"rating-score"},{default:l((()=>[r(o,{class:"score-text"},{default:l((()=>[d(m(ae.value)+"/10",1)])),_:1})])),_:1}),r(n,{class:"rating-comment"},{default:l((()=>[r(D,{class:"comment-input",modelValue:ee.value,"onUpdate:modelValue":e[2]||(e[2]=a=>ee.value=a),placeholder:"说说你的看法...（可选）",maxlength:"100"},null,8,["modelValue"])])),_:1})])),_:1}),r(n,{class:"rating-actions"},{default:l((()=>[r(A,{class:s(["rating-submit-btn",{active:ae.value>0}]),onClick:Pa},{default:l((()=>[d(" 提交评分 ")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})):f("",!0),r(n,{class:s(["music-btn",{playing:Qa.value}]),onClick:ne},{default:l((()=>[r(o,{class:"music-icon"},{default:l((()=>[d("♪")])),_:1})])),_:1},8,["class"]),xa.value?(u(),t(n,{key:4,class:"fireworks"},{default:l((()=>[(u(!0),v(g,null,_(Ca.value,(a=>(u(),t(n,{key:a.id,class:"fw",style:h({left:a.x+"%",top:a.y+"%"})},{default:l((()=>[(u(),v(g,null,_(12,(e=>r(n,{key:e,class:s(["fw-p","p"+e,a.theme])},null,8,["class"]))),64))])),_:2},1032,["style"])))),128))])),_:1})):f("",!0)])),_:1},8,["class"])}}},[["__scopeId","data-v-735b2242"]]);export{Q as default};
