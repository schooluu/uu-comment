import{o as a,c as e,w as s,a as l,i as t,d as c,r as n,g as u,b as o,e as d,f as i,n as f,u as r,h as _,t as p,j as m,k as v,F as y,l as g,Y as k,s as b,m as h,p as x,q as C,v as w,x as F,I as S,y as q,z as I}from"./index-CL_BCzV3.js";import{_ as L,o as j,r as T,a as $}from"./uni-rate.DN3BOT3k.js";import{_ as z}from"./uni-popup.C-qxIfNC.js";const D=L({},[["render",function(c,n){const u=t;return a(),e(u,{class:"skeleton-card glass-effect"},{default:s((()=>[l(u,{class:"card-header"},{default:s((()=>[l(u,{class:"company-name skeleton-bg"}),l(u,{class:"rating-wrapper"},{default:s((()=>[l(u,{class:"rating skeleton-bg"})])),_:1})])),_:1}),l(u,{class:"card-content"},{default:s((()=>[l(u,{class:"cons-box skeleton-bg"})])),_:1}),l(u,{class:"card-footer"},{default:s((()=>[l(u,{class:"stats"},{default:s((()=>[l(u,{class:"stat-item skeleton-bg"}),l(u,{class:"stat-item skeleton-bg"}),l(u,{class:"date skeleton-bg"})])),_:1}),l(u,{class:"city-tag skeleton-bg"})])),_:1})])),_:1})}],["__scopeId","data-v-c515b885"]]),V=L(c({__name:"index",setup(c){const L=n([]),V=n(""),B=n(null),P=n(1),Y=n(!0),H=n(!1),M=n(""),N=n([]),U=n([]),A=n(""),E=u().statusBarHeight,G=a=>{const e=new Date(a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},J=async(a=1,e=!1)=>{e||(H.value=!0);try{const{result:s}=await k.callFunction({name:"getCompanyList",data:{page:a,pageSize:10,keyword:V.value,city:M.value}});0===s.code&&(e?L.value=[...L.value,...s.data]:setTimeout((()=>{L.value=s.data,H.value=!1}),500),Y.value=10===s.data.length,P.value=a)}catch(s){b({title:"获取数据失败",icon:"none"}),H.value=!1}},K=()=>{L.value=[],P.value=1,Y.value=!0,J(1)},O=()=>{K()},Q=()=>{V.value="",K()},R=()=>{h({url:"/pages/add/add-review"})};o((()=>{J()}));const W=()=>{x("hasShownDisclaimer",!0),B.value.close()},X=n(null),Z=()=>{X.value.open()},aa=()=>{X.value.close()},ea=()=>{C({data:"962723968@qq.com",success:()=>{b({title:"邮箱已复制",icon:"success"})}})};j((()=>{(async()=>{Y.value&&!H.value&&await J(P.value+1,!0)})()})),o((()=>{J()}));const sa=()=>{w({itemList:N.value.map((a=>a.name)),success:async a=>{const e=N.value[a.tapIndex];A.value=e.name,await(async a=>{try{const{result:e}=await k.callFunction({name:"getCityList",data:{province:a}});0===e.code&&(U.value=e.data)}catch(e){b({title:"获取城市失败",icon:"none"})}})(e.code),w({itemList:U.value.map((a=>a.name)),success:a=>{M.value=U.value[a.tapIndex].name,K()}})}})};return o((async()=>{await(async()=>{try{const{result:a}=await k.callFunction({name:"getCityList"});0===a.code&&(N.value=a.data)}catch(a){b({title:"获取省份失败",icon:"none"})}})(),J()})),(c,n)=>{const u=F,o=t,k=S,b=q,x=T(d("uni-rate"),$),C=I,w=T(d("uni-popup"),z);return a(),e(o,{class:"container"},{default:s((()=>[l(o,{class:"nav-bar",style:f({paddingTop:r(E)+"px"})},{default:s((()=>[l(o,{class:"nav-content"},{default:s((()=>[l(o,{class:"nav-left"},{default:s((()=>[l(u,{class:"app-title"},{default:s((()=>[i("人人点评")])),_:1}),l(u,{class:"app-subtitle"},{default:s((()=>[i("匿名化点评，避雷指南")])),_:1})])),_:1}),l(o,{class:"nav-right"},{default:s((()=>[l(o,{class:"nav-btn",onClick:Z},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("📢")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),l(o,{class:"search-section",style:f({marginTop:r(E)+88+"rpx"})},{default:s((()=>[l(o,{class:"search-wrapper glass-effect"},{default:s((()=>[l(o,{class:"search-input-box"},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("🔍")])),_:1}),l(k,{class:"input",modelValue:V.value,"onUpdate:modelValue":n[0]||(n[0]=a=>V.value=a),placeholder:"搜索点评标题","placeholder-class":"placeholder","confirm-type":"search",onConfirm:O},null,8,["modelValue"]),V.value?(a(),e(u,{key:0,class:"clear-icon",onClick:Q},{default:s((()=>[i("✕")])),_:1})):_("",!0)])),_:1}),l(o,{class:"divider"}),l(o,{class:"location-picker",onClick:sa},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("📍")])),_:1}),l(u,{class:"location-text"},{default:s((()=>[i(p(M.value||"选择城市"),1)])),_:1}),l(u,{class:"icon-arrow"},{default:s((()=>[i("▼")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),H.value?(a(),m(y,{key:0},v(5,(a=>l(D,{key:a}))),64)):_("",!0),l(o,{class:g(["company-list",{"fade-in":!H.value}])},{default:s((()=>[H.value?(a(),m(y,{key:0},[],64)):0===L.value.length?(a(),e(o,{key:1,class:"empty-state"},{default:s((()=>[l(b,{class:"empty-image",src:"./static/images/empty.png",mode:"aspectFit"}),l(u,{class:"empty-text"},{default:s((()=>[i("暂无数据")])),_:1}),l(u,{class:"empty-tips"},{default:s((()=>[i("快来添加第一条评价吧")])),_:1}),l(o,{class:"empty-btn",onClick:R},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("✏️")])),_:1}),l(u,{class:"text"},{default:s((()=>[i("写点评")])),_:1})])),_:1})])),_:1})):(a(!0),m(y,{key:2},v(L.value,((t,c)=>(a(),e(o,{key:t._id,class:"company-card glass-effect",style:f({"--index":c}),"hover-class":"company-card-hover",onClick:a=>{return e=t._id,void h({url:`/pages/detail/detail?id=${e}`});var e}},{default:s((()=>[l(o,{class:"card-header"},{default:s((()=>[l(u,{class:"company-name"},{default:s((()=>[i(p(t.companyName),1)])),_:2},1024),l(o,{class:"rating-wrapper"},{default:s((()=>[l(x,{value:t.rating,size:"18",color:"#FFB800"},null,8,["value"]),l(u,{class:"rating-text"},{default:s((()=>[i(p(t.rating||0),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),l(o,{class:"card-content"},{default:s((()=>[t.cons?(a(),e(o,{key:0,class:"cons-box"},{default:s((()=>[l(u,{class:"cons-text"},{default:s((()=>[i(p(t.cons),1)])),_:2},1024)])),_:2},1024)):_("",!0)])),_:2},1024),l(o,{class:"card-footer"},{default:s((()=>[l(o,{class:"stats"},{default:s((()=>[l(o,{class:"stat-item"},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("👁️")])),_:1}),l(u,{class:"count"},{default:s((()=>[i(p(t.viewCount||0),1)])),_:2},1024)])),_:2},1024),l(o,{class:"stat-item"},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("💬")])),_:1}),l(u,{class:"count"},{default:s((()=>[i(p(t.reviewCount||0),1)])),_:2},1024)])),_:2},1024),l(u,{class:"date"},{default:s((()=>[i(p(G(t.createTime)),1)])),_:2},1024)])),_:2},1024),l(u,{class:"city-tag"},{default:s((()=>[i(p(t.city),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1},8,["class"]),l(o,{class:"float-btns"},{default:s((()=>[l(o,{class:"float-btn glass-effect complaint-btn",onClick:Z},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("📢")])),_:1})])),_:1}),l(o,{class:"float-btn glass-effect",onClick:R},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("✏️")])),_:1})])),_:1})])),_:1}),l(w,{ref_key:"disclaimerPopup",ref:B,type:"center"},{default:s((()=>[l(o,{class:"disclaimer-popup"},{default:s((()=>[l(o,{class:"popup-header"},{default:s((()=>[l(u,{class:"title"},{default:s((()=>[i("免责声明")])),_:1})])),_:1}),l(o,{class:"popup-content"},{default:s((()=>[l(u,{class:"text"},{default:s((()=>[i("1. 本平台仅提供信息分享服务，所有内容均来自用户发布。")])),_:1}),l(u,{class:"text"},{default:s((()=>[i("2. 用户发布的内容仅代表个人观点，请理性对待。")])),_:1}),l(u,{class:"text"},{default:s((()=>[i("3. 如发现违规内容，请及时联系我们处理。")])),_:1}),l(u,{class:"text"},{default:s((()=>[i("4. 平台保留对违规内容的处理权利。")])),_:1})])),_:1}),l(o,{class:"popup-footer"},{default:s((()=>[l(C,{class:"confirm-btn",onClick:W},{default:s((()=>[i("我已了解")])),_:1})])),_:1})])),_:1})])),_:1},512),L.value.length>0?(a(),e(o,{key:1,class:"load-more"},{default:s((()=>[H.value?(a(),e(o,{key:0,class:"loading"},{default:s((()=>[l(o,{class:"loading-icon"}),l(u,{class:"loading-text"},{default:s((()=>[i("加载中...")])),_:1})])),_:1})):Y.value?_("",!0):(a(),e(u,{key:1,class:"no-more"},{default:s((()=>[i("没有更多了")])),_:1}))])),_:1})):_("",!0),l(w,{ref_key:"complaintPopup",ref:X,type:"center"},{default:s((()=>[l(o,{class:"complaint-popup glass-effect"},{default:s((()=>[l(o,{class:"popup-header"},{default:s((()=>[l(u,{class:"title"},{default:s((()=>[i("投诉建议")])),_:1}),l(u,{class:"close-icon",onClick:aa},{default:s((()=>[i("✕")])),_:1})])),_:1}),l(o,{class:"popup-content"},{default:s((()=>[l(o,{class:"content-item"},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("📧")])),_:1}),l(o,{class:"item-info"},{default:s((()=>[l(u,{class:"label"},{default:s((()=>[i("邮箱联系")])),_:1}),l(u,{class:"value"},{default:s((()=>[i("962723968@qq.com")])),_:1})])),_:1}),l(C,{class:"copy-btn",onClick:ea},{default:s((()=>[i("复制")])),_:1})])),_:1}),l(o,{class:"content-item"},{default:s((()=>[l(u,{class:"icon"},{default:s((()=>[i("⚠️")])),_:1}),l(o,{class:"item-info"},{default:s((()=>[l(u,{class:"label"},{default:s((()=>[i("温馨提示")])),_:1}),l(u,{class:"desc"},{default:s((()=>[i("如发现任何违规或不当内容，请及时联系我们处理，我们会在24小时内给予回复。")])),_:1})])),_:1})])),_:1})])),_:1}),l(o,{class:"popup-footer"},{default:s((()=>[l(C,{class:"confirm-btn",onClick:aa},{default:s((()=>[i("我知道了")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}}),[["__scopeId","data-v-bb1fdd6e"]]);export{V as default};
