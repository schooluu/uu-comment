import{r as t,o as a,a2 as e,e as s,w as o,k as l,l as c,s as n,a4 as i,x as u,c as r,f as m,h as p,t as f,A as d,u as h,n as g,i as v,j as _,F as b,B as w,W as k,H as y,J as q,m as x,a1 as C,a5 as M,q as T,D as j,v as F,y as I,U as L,I as E,z as U,S as $}from"./index-BvzvZyX9.js";import{a as S,b as A,c as P,o as z,d as V}from"./uni-app.es.BES553Wo.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=N({__name:"index",setup(N){const D=["星河旅人","夏日微风","蓝莓汽水","橙子汽球","夜空守望","晨曦微光","云端漫步","月下独行","白茶清欢","青柠时光","温柔星球","晴空万里","风中诗人","海盐冰沙","山野听风","橘子海岸","银河信使","微光拾梦","晚风邮差","雾里看花","森林之心","雨后初晴","云朵收集者","夏夜萤火"];function H(){return D[Math.floor(Math.random()*D.length)]}const J=["https://images.unsplash.com/photo-1502685104226-ee32379fefbe?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1527980965255-d3b416303d12?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1531123897727-8f129e1688ce?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1534528741775-53994a69daeb?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1541271696563-3be2f555fc4e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1496345875659-11f7dd282d1d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1552374196-c4e7ffc6e126?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1516822003754-cca485356ecb?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1519345182560-3f2917c472ef?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1542202229-7d93c33f5d07?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1544006659-f0b21884ce1d?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1521119989659-a83eee488004?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1546961329-78bef0414d7c?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1601455763557-db1bea8a9a5a?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1580489944761-15a19d654956?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1607746882042-944635dfe10e?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1594744803329-e58b31de8bf5?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1568602471122-7832951cc4c5?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1566492031773-4f4e44671857?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1558898479-33c0057a5d12?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1599566150163-29194dcaad36?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506277886164-e25aa3f4ef7f?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1503454537195-1dcabb73ffb9?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1522556189639-b150ed9c4330?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1463453091185-61582044d556?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1506919258185-6078bba55d2a?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1499996860823-5214fcc65f8f?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1545996124-0501ebae84d0?auto=format&fit=crop&w=256&q=60","https://images.unsplash.com/photo-1513956589380-bad6acb9b9d4?auto=format&fit=crop&w=256&q=60"],Q=J[Math.floor(Math.random()*J.length)],B=["https://images.unsplash.com/photo-1557672172-298e090bd0f1?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1506905925346-21bda4d32df4?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1475924156734-496f6cac6ec1?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=1400&q=80","https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=1400&q=80"],O=B[Math.floor(Math.random()*B.length)],R=Q,W=["今天也要元气满满！","匿名分享，轻松自在~","每一天都值得记录。","用心感受生活的美好。","科技让匿名更温暖。","世界很大，心情很美。","做自己的小太阳 ☀️","匿名不孤单，温暖在身边。","记录此刻，遇见更好的自己。","保持好奇，保持热爱！"],Y=W[Math.floor(Math.random()*W.length)],G=["匿名树洞 · 美好生活","用温柔治愈世界","每一天都值得记录","让心情自由流动","科技让温暖发生","在这里遇见美好","分享你的故事","做自己的小太阳","世界很大，温暖很近","用匿名守护真心"];t(G[0]);const K=t(""),X=t(!0);let Z=null,tt=0,at=0;function et(){clearTimeout(Z);const t=G[tt];K.value="",at=0,function a(){at<=t.length?(K.value=t.slice(0,at),at++,Z=setTimeout(a,60)):setTimeout((()=>{tt=(tt+1)%G.length,et()}),1800)}()}a((()=>{et(),setInterval((()=>{X.value=!X.value}),500),ia()})),e((()=>{Z&&clearTimeout(Z)}));const st=t(!1),ot=t(!1),lt=t(""),ct=t([]),nt=t(-1),it=t({}),ut=t(1),rt=t(10),mt=t(!1),pt=t(!0),ft=t([]),dt=t({isLive:!0,url:"https://gcalic.v.myalicdn.com/gc/zsslsjjfsd_1/index.m3u8",title:"精彩直播",host:"官方频道",viewerCount:12580,muted:!1,alternativeUrls:["https://gcalic.v.myalicdn.com/gc/zsslsjjfsd_1/index.m3u8","http://cctvalih5ca.v.myalicdn.com/live/cctv1_2/index.m3u8","http://cctvalih5ca.v.myalicdn.com/live/cctv2_2/index.m3u8"]});let ht=0;const gt=t=>{dt.value.alternativeUrls&&ht<dt.value.alternativeUrls.length-1?(ht++,dt.value.url=dt.value.alternativeUrls[ht],n({title:`切换到备用源${ht+1}`,icon:"none",duration:1500})):k({title:"直播加载失败",content:"无法加载直播流，请检查网络连接或联系管理员。\n\n提示：blob:// 协议的URL无法在移动端使用，需要使用 http/https 的流媒体地址（如 .m3u8）",showCancel:!1,confirmText:"知道了"})},vt=()=>{ht=dt.value.alternativeUrls.findIndex((t=>t===dt.value.url)),-1===ht&&(ht=0)},_t=()=>{dt.value.muted=!dt.value.muted,n({title:dt.value.muted?"已静音":"已开启声音",icon:"none",duration:1e3})},bt=async(t=!1)=>{if(!mt.value&&(pt.value||t))try{mt.value=!0;const e=new Promise((t=>setTimeout(t,800))),[{result:s}]=await Promise.all([c.callFunction({name:"wx_get_list",data:{page:t?1:ut.value,pageSize:rt.value}}),e]);if(0!==s.code)throw new Error(s.msg);{const e=s.data.list.map((t=>({...t,username:H(),avatar:J[Math.floor(Math.random()*J.length)],comments:(t.comments||[]).map((t=>({...t,images:t.images||[],username:H(),avatar:J[Math.floor(Math.random()*J.length)]}))),likes:(t.likes||[]).map((()=>H()))})));if(t)ft.value=e,ut.value=2;else{const t=new Set((ft.value||[]).map((t=>t._id))),a=e.filter((a=>!t.has(a._id)));ft.value=[...ft.value||[],...a],ut.value++}pt.value=s.data.hasMore;try{Ht()}catch(a){}}}catch(e){n({title:e.message||"获取朋友圈失败",icon:"none"})}finally{mt.value=!1,t&&i()}};S((()=>{bt(!0),setTimeout((()=>{bt(!0)}),33e3),ea()})),A((()=>{Zt()})),P((()=>{Zt()})),z((()=>{!mt.value&&pt.value&&bt()}));const wt=async()=>{if(!lt.value.trim()&&0===ct.value.length)return;const t=lt.value,a=[...ct.value];st.value=!1,ot.value=!1,lt.value="",ct.value=[],y({title:"发送中...",mask:!0});try{const{result:e}=await c.callFunction({name:"wx_add_comment",data:{momentId:ft.value[nt.value]._id,content:t,images:a}});if(0!==e.code)throw new Error(e.msg||"评论失败");{const s=ft.value[nt.value];s.comments||(s.comments=[]);const o=J[Math.floor(Math.random()*J.length)];s.comments.push({username:H(),avatar:o,content:t,images:a,create_time:Date.now(),isNew:!0}),setTimeout((()=>{const t=s.comments.length-1;s.comments[t]&&delete s.comments[t].isNew}),500),q();const l=e.msg||"评论成功";n({title:l,icon:"success",duration:1500})}}catch(e){q(),n({title:e.message||"评论失败",icon:"none",duration:2e3})}},kt=async()=>{x({url:"/pages/wx/home/add"})},yt=()=>{st.value=!1,ot.value=!1,lt.value="",ct.value=[],nt.value=-1},qt=()=>{ot.value=!ot.value},xt=()=>{ct.value.length>=3?n({title:"最多上传3张图片",icon:"none"}):C({count:3-ct.value.length,sizeType:["compressed"],sourceType:["album","camera"],success:async t=>{y({title:"上传中..."});try{const a=t.tempFilePaths.map((t=>new Promise(((a,e)=>{M({url:"http://117.72.208.124:40027/api/v1/upload",filePath:t,name:"file",success:t=>{try{const s=JSON.parse(t.data);s.status?a(s.data.links.url):e(new Error(s.message||"上传失败"))}catch(s){e(new Error("解析上传结果失败"))}},fail:t=>{e(t)}})})))),e=await Promise.all(a);ct.value.push(...e),q(),n({title:"上传成功",icon:"success"})}catch(a){q(),n({title:a.message||"上传失败",icon:"none"})}}})},Ct=(t,a)=>{t&&t.length&&T({urls:t,current:a})},Mt=()=>{n({title:"视频加载失败",icon:"none"})},Tt=()=>{j({itemList:["切换主题","内容偏好","帮助与反馈"],success:t=>{const a=t.tapIndex;0===a&&n({title:"已切换主题",icon:"none"}),1===a&&n({title:"偏好设置暂未开放",icon:"none"}),2===a&&n({title:"感谢你的反馈",icon:"none"})}})},jt=t(0);V((t=>{const a=t.scrollTop||0;jt.value=Math.min(30,.2*a)}));const Ft=t("theme-day"),It=()=>{const t=(new Date).getHours();Ft.value=t>=6&&t<11?"theme-morning":t>=11&&t<18?"theme-day":"theme-night"};a((()=>{It(),setInterval(It,6e5)}));const Lt=t=>t||0===t?t>=1e4?(t/1e4).toFixed(1).replace(/\.0$/,"")+"w":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"k":String(t):"0",Et=t=>{const a=t.likes&&t.likes.length||0,e=t.comments&&t.comments.length||0,s="video"===t.mediaType;return Math.floor(3*a+5*e+(s?18:8))};t("recommend");const Ut=t({});t([{tag:"# 精选",title:"今日热聊：匿名也要有态度",sub:"来一条走心的分享吧"},{tag:"# 新鲜",title:"你的小确幸，值得被看到",sub:"记录当下，温暖一整天"},{tag:"# 附近",title:"发现身边的美好瞬间",sub:"同城热点，马上加入"}]);t([{text:"# 今天你匿名表白了吗",views:"12.3w",posts:"2.1k",emoji:"💌",badge:"热议",badgeType:"badge-hot",cta:"参与"},{text:"# 城市树洞：你的小烦恼",views:"8.7w",posts:"1.2k",emoji:"🌆",badge:"同城",badgeType:"badge-near",cta:"去看看",mood:"氛围很暖"},{text:"# 三件让你快乐的小事",views:"6.5w",posts:"980",emoji:"✨",badge:"精选",badgeType:"badge-new",cta:"我也分享"}]);const $t=t(!1);let St=null;const At=[];let Pt=Math.floor(Math.random()*At.length);const zt=()=>At[Pt%At.length],Vt=()=>"undefined"==typeof Audio?null:(St||(St=new Audio(zt()),St.loop=!0,St.preload="auto",St.volume=.6,St.onerror=()=>{try{const t=(Pt=(Pt+1)%At.length,zt());St.src=t,$t.value&&St.play().catch((()=>{$t.value=!1,n({title:"背景音乐需手动播放",icon:"none"})}))}catch(t){}}),St),Nt=["today vibes","mood on","little joy","city walk","coffee o’clock","soft light","daily look","slow life"],Dt=t([]),Ht=()=>{const t=(()=>{const t=[];return(ft.value||[]).forEach((a=>{"image"===a.mediaType&&Array.isArray(a.mediaUrls)&&a.mediaUrls.forEach((a=>{a&&t.push({url:a})})),Array.isArray(a.mediaList)&&a.mediaList.filter((t=>t&&"image"===t.type&&t.url)).forEach((a=>t.push({url:a.url})))})),t})();if(!t.length)return void(Dt.value=[]);const a=t.sort((()=>Math.random()-.5)).slice(0,8);Dt.value=a.map((t=>({...t,likes:Math.floor(100+9e3*Math.random()),emoji:["💖","🌸","📸","😊","☕","👗","🧋","✨"][Math.floor(8*Math.random())],caption:Nt[Math.floor(Math.random()*Nt.length)]})))},Jt=()=>{Ht()},Qt=t=>({beauty:"颜值评分",style:"穿搭评分",photo:"照片评分"}[t]||"评分"),Bt=t(!1),Ot=t(null),Rt=t(0),Wt=t(""),Yt=t(-1);S((()=>{setTimeout((()=>Ht()),400),Kt()})),A((()=>{Xt()})),P((()=>{Xt()}));let Gt=null;const Kt=()=>{Gt||(Gt=setInterval((()=>{Ht()}),5e3))},Xt=()=>{Gt&&(clearInterval(Gt),Gt=null)},Zt=()=>{if(St)try{St.pause()}catch(t){}$t.value=!1};let ta=!1;const aa=()=>{ea()},ea=()=>{const t=Vt();t&&(t.muted=!0,t.volume=0,t.play().then((()=>{$t.value=!0,t.muted=!1,((t=.6,a=1200)=>{const e=St;if(!e)return;const s=e.volume||0,o=Math.max(1,Math.floor(a/80));let l=0;const c=setInterval((()=>{l++,e.volume=s+l/o*(t-s),l>=o&&clearInterval(c)}),80)})(.6,1200),"undefined"!=typeof document&&(["touchstart","click","wheel","keydown"].forEach((t=>{try{document.removeEventListener(t,aa)}catch(a){}})),ta=!1)})).catch((()=>{"undefined"==typeof document||ta||(["touchstart","click","wheel","keydown"].forEach((t=>{try{document.addEventListener(t,aa,{once:!0,passive:!0})}catch(a){}})),ta=!0)})))},sa=["😊","😂","🤣","❤️","😍","🤔","😒","👍","👎","😳","🥺","😭","😘","🤗","🙄","😴","🤮","🤧","😷","🤒","🤕","😈","👻","👽","🤖","💩","😺","💪","👊","✌️","🤞","🙏","👏","🙌","👐","🤲"],oa=t(!0),la=t(10);let ca=null;const na=()=>{oa.value=!1,ca&&(clearInterval(ca),ca=null)},ia=()=>{ca=setInterval((()=>{la.value--,la.value<=0&&na()}),1e3)},ua=async(t,a)=>{try{y({title:"处理中..."});const a=ft.value[t],{result:e}=await c.callFunction({name:"wx_del",data:{momentId:a._id}});if(0!==e.code)throw new Error(e.msg||"删除失败");ft.value.splice(t,1),q(),n({title:"举报已成功",icon:"none",duration:2e3})}catch(e){q(),n({title:e.message||"操作失败，请重试",icon:"none"})}};return(t,a)=>{const e=F,i=u,y=I,q=L,x=E,C=U,M=$;return r(),s(i,{class:l(["moments-container",Ft.value,{"disclaimer-hidden":!oa.value}])},{default:o((()=>[oa.value?(r(),s(i,{key:0,class:"disclaimer-banner"},{default:o((()=>[m(i,{class:"disclaimer-banner-content"},{default:o((()=>[m(i,{class:"disclaimer-banner-left"},{default:o((()=>[m(e,{class:"disclaimer-banner-icon"},{default:o((()=>[p("⚠️")])),_:1}),m(e,{class:"disclaimer-banner-text"},{default:o((()=>[p(" 本网站仅供编程学习交流使用，非商业网站，所有内容均为学习演示，真实性无法保证。请理性对待，切勿轻信。严禁发布违法违规内容，用户需对发布内容负责。 ")])),_:1})])),_:1}),m(i,{class:"disclaimer-banner-right"},{default:o((()=>[m(e,{class:"disclaimer-banner-timer"},{default:o((()=>[p(f(la.value)+"s",1)])),_:1}),m(e,{class:"disclaimer-banner-close",onClick:na},{default:o((()=>[p("✕")])),_:1})])),_:1})])),_:1})])),_:1})):d("",!0),m(i,{class:"header"},{default:o((()=>[m(y,{class:"bg-image",src:h(O),mode:"aspectFill",style:g({transform:`translateY(${jt.value}px) scale(1.06)`})},null,8,["src","style"]),m(i,{class:"header-gradient"}),m(i,{class:"header-blur"}),m(i,{class:"header-glow"}),m(i,{class:"header-topbar"},{default:o((()=>[m(e,{class:"brand"},{default:o((()=>[p("匿名圈")])),_:1}),m(i,{class:"top-actions"},{default:o((()=>[m(e,{class:"top-icon",onClick:Tt},{default:o((()=>[p("⋯")])),_:1})])),_:1})])),_:1}),m(i,{class:"hero-card"},{default:o((()=>[m(y,{class:"hero-avatar",src:h(R),mode:"aspectFill"},null,8,["src"]),m(i,{class:"hero-text"},{default:o((()=>[m(e,{class:"hero-title"},{default:o((()=>[p(f(h(Y)),1)])),_:1}),m(e,{class:"hero-sub"},{default:o((()=>[p("匿名 · 温暖 · 真实")])),_:1}),m(i,{class:"hero-chips"},{default:o((()=>[m(e,{class:"chip active"},{default:o((()=>[p("推荐")])),_:1}),m(e,{class:"chip"},{default:o((()=>[p("关注")])),_:1}),m(e,{class:"chip"},{default:o((()=>[p("附近")])),_:1})])),_:1})])),_:1})])),_:1}),m(i,{class:"floating-btn",onClick:kt},{default:o((()=>[m(i,{class:"floating-btn-pulse"}),m(i,{class:"floating-btn-inner"},{default:o((()=>[m(y,{class:"floating-btn-icon",src:"https://img.icons8.com/fluency/48/plus.png",mode:"aspectFit"})])),_:1}),m(e,{class:"floating-btn-label"},{default:o((()=>[p("发布")])),_:1})])),_:1})])),_:1}),Dt.value.length?(r(),s(i,{key:1,class:"photo-showcase"},{default:o((()=>[m(i,{class:"ps-header"},{default:o((()=>[m(e,{class:"ps-title"},{default:o((()=>[p("最美照片")])),_:1}),m(e,{class:"ps-action",onClick:Jt},{default:o((()=>[p("换一换")])),_:1})])),_:1}),m(i,{class:"ps-row"},{default:o((()=>[(r(!0),v(b,null,_(Dt.value,((t,a)=>(r(),s(i,{class:"ps-item",key:a,onClick:t=>(t=>{const a=Dt.value.map((t=>t.url));T({urls:a,current:a[t]})})(a)},{default:o((()=>[m(y,{class:"ps-img",src:t.url,mode:"aspectFill"},null,8,["src"]),m(i,{class:"ps-overlay"},{default:o((()=>[m(i,{class:"ps-cap"},{default:o((()=>[m(e,{class:"ps-emoji"},{default:o((()=>[p(f(t.emoji),1)])),_:2},1024),m(e,{class:"ps-text"},{default:o((()=>[p(f(t.caption),1)])),_:2},1024)])),_:2},1024),m(e,{class:"ps-like"},{default:o((()=>[p("❤ "+f(Lt(t.likes)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):d("",!0),dt.value.isLive?(r(),s(i,{key:2,class:"live-section"},{default:o((()=>[m(i,{class:"live-video-wrapper"},{default:o((()=>[m(q,{src:dt.value.url,class:"live-video",controls:"",autoplay:"",muted:dt.value.muted,"show-center-play-btn":"","enable-play-gesture":"","show-fullscreen-btn":"","show-play-btn":"","object-fit":"contain","initial-time":0,"enable-auto-rotation":!0,"show-mute-btn":!0,direction:"0","x5-video-player-type":"h5","x5-video-player-fullscreen":"true","x5-video-orientation":"portraint",onError:gt,onPlay:vt},null,8,["src","muted"]),dt.value.muted?(r(),s(i,{key:0,class:"live-mute-btn",onClick:_t},{default:o((()=>[m(e,{class:"mute-icon"},{default:o((()=>[p("🔇")])),_:1}),m(e,{class:"mute-text"},{default:o((()=>[p("点击开启声音")])),_:1})])),_:1})):d("",!0)])),_:1})])),_:1})):d("",!0),m(i,{class:"moments-list"},{default:o((()=>[(r(!0),v(b,null,_(ft.value,((t,a)=>(r(),s(i,{class:"moment-item",key:a},{default:o((()=>[m(y,{class:"user-avatar avatar-glow",src:t.avatar,mode:"aspectFill"},null,8,["src"]),m(i,{class:"content-area"},{default:o((()=>[m(i,{class:"meta-row"},{default:o((()=>[m(e,{class:"username"},{default:o((()=>[p(f(t.username),1)])),_:2},1024)])),_:2},1024),m(i,{class:"chip-row"},{default:o((()=>[m(e,{class:"chip"},{default:o((()=>[p("匿名")])),_:1}),t.mediaType?(r(),s(e,{key:0,class:"chip ghost"},{default:o((()=>[p("图文")])),_:1})):d("",!0)])),_:2},1024),m(i,{class:l(["text-block",{clamped:!Ut.value[a]}])},{default:o((()=>[m(e,{class:"text-content"},{default:o((()=>[p(f(t.content),1)])),_:2},1024)])),_:2},1032,["class"]),t.content&&t.content.length>60?(r(),s(i,{key:0,class:"expand-btn",onClick:t=>(t=>{Ut.value[t]=!Ut.value[t]})(a)},{default:o((()=>[p(f(Ut.value[a]?"收起":"展开"),1)])),_:2},1032,["onClick"])):d("",!0),t.mediaType?(r(),s(i,{key:1,class:"media-content"},{default:o((()=>["video"===t.mediaType?(r(),s(q,{key:0,src:t.mediaUrl,poster:t.poster,class:"video-content video-radius",controls:"","show-center-play-btn":"","enable-play-gesture":"","show-fullscreen-btn":"","show-play-btn":"","object-fit":"contain",onError:Mt},null,8,["src","poster"])):"image"===t.mediaType?(r(),s(i,{key:1,class:l(["image-gallery",`columns-${t.mediaUrls.length}`])},{default:o((()=>[(r(!0),v(b,null,_(t.mediaUrls,((a,e)=>(r(),s(y,{key:e,src:a,mode:"aspectFill",class:"image-content image-radius",onClick:e=>Ct(t.mediaUrls,a)},null,8,["src","onClick"])))),128))])),_:2},1032,["class"])):d("",!0),m(i,{class:"media-badges"},{default:o((()=>[m(i,{class:"badge ghost"},{default:o((()=>[m(e,{class:"b-ic"},{default:o((()=>[p("🔥")])),_:1}),m(e,{class:"b-txt"},{default:o((()=>[p(f(Lt(Et(t))),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)):d("",!0),m(i,{class:"bottom-info"},{default:o((()=>[m(e,{class:"time"},{default:o((()=>[p(f(t.time),1)])),_:2},1024),m(i,{class:"actions"},{default:o((()=>[m(i,{class:l(["action-btn like-btn",{liked:t.isLiked,animating:it.value[a]}]),onClick:t=>(async t=>{try{const a=ft.value[t];it.value[t]=!0;const{result:e}=await c.callFunction({name:"wx_add_toggle_like",data:{momentId:a._id}});if(0!==e.code)throw new Error(e.msg);a.isLiked=e.data.isLiked,a.isLiked?(a.likes||(a.likes=[]),a.likes.push(H())):a.likes.pop(),setTimeout((()=>{it.value[t]=!1}),1e3)}catch(a){n({title:a.message||"操作失败",icon:"none"})}})(a)},{default:o((()=>[m(e,{class:"icon iconfont"},{default:o((()=>[p(f(t.isLiked?"❤️":"🤍"),1)])),_:2},1024),m(e,{class:"action-text"},{default:o((()=>[p(f(t.isLiked?"已赞":"点赞"),1)])),_:2},1024),m(e,{class:"action-count"},{default:o((()=>[p(f(t.likes&&t.likes.length||0),1)])),_:2},1024),it.value[a]?(r(),s(i,{key:0,class:"like-burst-particles"},{default:o((()=>[(r(),v(b,null,_(8,(t=>m(i,{key:t,class:l(["particle","p"+t])},null,8,["class"]))),64))])),_:1})):d("",!0)])),_:2},1032,["class","onClick"]),m(i,{class:"action-btn comment-btn",onClick:t=>(t=>{nt.value=t,st.value=!0})(a)},{default:o((()=>[m(e,{class:"icon iconfont"},{default:o((()=>[p("💬")])),_:1}),m(e,{class:"action-text"},{default:o((()=>[p("评论")])),_:1}),m(e,{class:"action-count"},{default:o((()=>[p(f(t.comments&&t.comments.length||0),1)])),_:2},1024)])),_:2},1032,["onClick"]),m(i,{class:"action-btn report-btn",onClick:t=>(t=>{ft.value[t],j({title:"举报内容",itemList:["色情低俗","暴力血腥","政治敏感","诈骗信息","垃圾广告","其他违规"],success:a=>{const e=["色情低俗","暴力血腥","政治敏感","诈骗信息","垃圾广告","其他违规"][a.tapIndex];k({title:"确认举报",content:`确定要举报此内容为"${e}"吗？`,success:a=>{a.confirm&&ua(t)}})}})})(a)},{default:o((()=>[m(e,{class:"icon iconfont"},{default:o((()=>[p("🚨")])),_:1}),m(e,{class:"action-text"},{default:o((()=>[p("举报")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),t.likes&&t.likes.length?(r(),s(i,{key:2,class:"likes-section"},{default:o((()=>[m(e,{class:"like-users"},{default:o((()=>[p(f(t.likes.join("、")),1)])),_:2},1024)])),_:2},1024)):d("",!0),t.contactValue?(r(),s(i,{key:3,class:"contact-section"},{default:o((()=>[m(e,{class:"contact-icon"},{default:o((()=>[p("📞")])),_:1}),m(e,{class:"contact-text"},{default:o((()=>{return[p(f((a=t.contactType,{wechat:"微信",phone:"手机",qq:"QQ",email:"邮箱"}[a]||"联系"))+"："+f(t.contactValue),1)];var a})),_:2},1024)])),_:2},1024)):d("",!0),t.ratingType?(r(),s(i,{key:4,class:"rating-section"},{default:o((()=>[m(i,{class:"rating-header"},{default:o((()=>[m(e,{class:"rating-icon"},{default:o((()=>[p("⭐")])),_:1}),m(e,{class:"rating-title"},{default:o((()=>[p(f(Qt(t.ratingType)),1)])),_:2},1024),m(e,{class:"rating-range"},{default:o((()=>[p("("+f(t.ratingMin)+"-"+f(t.ratingMax)+"分)",1)])),_:2},1024)])),_:2},1024),t.ratingStats?(r(),s(i,{key:0,class:"rating-stats"},{default:o((()=>[m(i,{class:"rating-avg"},{default:o((()=>[m(e,{class:"avg-score"},{default:o((()=>[p(f(t.ratingStats.average.toFixed(1)),1)])),_:2},1024),m(e,{class:"avg-label"},{default:o((()=>[p("平均分")])),_:1})])),_:2},1024),m(i,{class:"rating-count"},{default:o((()=>[m(e,{class:"count-num"},{default:o((()=>[p(f(t.ratingStats.count),1)])),_:2},1024),m(e,{class:"count-label"},{default:o((()=>[p("人评分")])),_:1})])),_:2},1024)])),_:2},1024)):d("",!0),m(i,{class:"rating-actions"},{default:o((()=>[m(i,{class:"rating-btn",onClick:t=>(t=>{Yt.value=t,Ot.value=ft.value[t],Rt.value=0,Wt.value="",Bt.value=!0})(a)},{default:o((()=>[m(e,{class:"rating-btn-icon"},{default:o((()=>[p("⭐")])),_:1}),m(e,{class:"rating-btn-text"},{default:o((()=>[p("评分")])),_:1})])),_:2},1032,["onClick"]),m(i,{class:"rating-btn",onClick:t=>(t=>{var a,e,s;const o=ft.value[t];k({title:`${Qt(o.ratingType)}详情`,content:`平均分：${(null==(e=null==(a=o.ratingStats)?void 0:a.average)?void 0:e.toFixed(1))||0}分\n评分人数：${(null==(s=o.ratingStats)?void 0:s.count)||0}人\n评分范围：${o.ratingMin}-${o.ratingMax}分`,showCancel:!1})})(a)},{default:o((()=>[m(e,{class:"rating-btn-icon"},{default:o((()=>[p("📊")])),_:1}),m(e,{class:"rating-btn-text"},{default:o((()=>[p("详情")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):d("",!0),t.comments&&0!==t.comments.length?(r(),s(i,{key:5,class:"comments-section"},{default:o((()=>[(r(!0),v(b,null,_(t.comments,((t,a)=>(r(),s(i,{class:l(["comment-item",{"new-comment":t.isNew}]),key:a},{default:o((()=>[m(y,{class:"comment-anon-icon",src:t.avatar||h(Q)},null,8,["src"]),m(i,{class:"comment-content-wrapper"},{default:o((()=>[m(i,{class:"comment-text-line"},{default:o((()=>[m(e,{class:"comment-user"},{default:o((()=>[p(f(t.username)+"：",1)])),_:2},1024),m(e,{class:"comment-content"},{default:o((()=>[p(f(t.content),1)])),_:2},1024)])),_:2},1024),t.images&&t.images.length>0?(r(),s(i,{key:0,class:"comment-images"},{default:o((()=>[(r(!0),v(b,null,_(t.images,((a,e)=>(r(),s(y,{key:e,src:a,mode:"aspectFill",class:"comment-image",onClick:e=>Ct(t.images,a)},null,8,["src","onClick"])))),128))])),_:2},1024)):d("",!0)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)):d("",!0)])),_:2},1024),m(i,{class:"more-btn",onClick:t=>{j({itemList:["举报","拉黑","不感兴趣"],success:t=>{const a=t.tapIndex;0===a?n({title:"已收到举报",icon:"none"}):1===a?n({title:"已拉黑该用户",icon:"none"}):2===a&&n({title:"将减少类似内容",icon:"none"})}})}},{default:o((()=>[p("⋯")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),st.value?(r(),s(i,{key:3,class:"comment-popup",onClick:yt},{default:o((()=>[m(i,{class:"comment-box animated-popup",onClick:a[1]||(a[1]=w((()=>{}),["stop"]))},{default:o((()=>[m(i,{class:"comment-input-area"},{default:o((()=>[m(x,{class:"comment-input",modelValue:lt.value,"onUpdate:modelValue":a[0]||(a[0]=t=>lt.value=t),placeholder:"@匿名用户 说点什么...",focus:st.value,onConfirm:wt},null,8,["modelValue","focus"]),ct.value.length>0?(r(),s(i,{key:0,class:"comment-images-preview"},{default:o((()=>[(r(!0),v(b,null,_(ct.value,((t,a)=>(r(),s(i,{class:"comment-preview-item",key:a},{default:o((()=>[m(y,{src:t,mode:"aspectFill",class:"comment-preview-img"},null,8,["src"]),m(e,{class:"comment-preview-delete",onClick:t=>{return e=a,void ct.value.splice(e,1);var e}},{default:o((()=>[p("✕")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})):d("",!0),m(i,{class:"toolbar"},{default:o((()=>[m(i,{class:"toolbar-left"},{default:o((()=>[m(i,{class:"toolbar-icon emoji-btn",onClick:qt},{default:o((()=>[m(e,{class:"icon-emoji"},{default:o((()=>[p("😊")])),_:1})])),_:1}),m(i,{class:"toolbar-icon image-btn",onClick:xt},{default:o((()=>[m(i,{class:"icon-wrapper"},{default:o((()=>[m(e,{class:"icon-camera"},{default:o((()=>[p("📸")])),_:1})])),_:1}),ct.value.length>0?(r(),s(e,{key:0,class:"icon-label"},{default:o((()=>[p(f(ct.value.length),1)])),_:1})):d("",!0)])),_:1})])),_:1}),m(C,{class:l(["submit-btn",{active:lt.value.trim()||ct.value.length>0}]),onClick:wt},{default:o((()=>[p("发送")])),_:1},8,["class"])])),_:1})])),_:1}),ot.value?(r(),s(i,{key:0,class:"emoji-panel"},{default:o((()=>[m(M,{"scroll-y":"",class:"emoji-list"},{default:o((()=>[m(i,{class:"emoji-group"},{default:o((()=>[(r(),v(b,null,_(sa,((t,a)=>m(e,{key:a,class:"emoji-item",onClick:a=>(t=>{lt.value+=t})(t)},{default:o((()=>[p(f(t),1)])),_:2},1032,["onClick"]))),64))])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1})])),_:1})):d("",!0)])),_:1},8,["class"])}}},[["__scopeId","data-v-54ca65e2"]]);export{D as default};
