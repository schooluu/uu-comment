import{r as e,o as a,s as l,e as s,w as t,x as u,c,f as o,h as n,t as d,i,j as r,k as f,F as m,A as v,G as p,W as _,v as h,I as g,L as k,a8 as y,z as b}from"./index-CZm5vXxk.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=V({__name:"address-edit",setup(V){const w=e(!1),C=e(!1),x=e(!1),A=["家","公司","学校"],D=e({name:"",phone:"",region:"",address:"",tag:"",isDefault:!1});a((()=>{const e=getQueryString("id");e&&(w.value=!0,U(e))}));const U=async e=>{try{const a=await getAddressDetail(e);D.value=a}catch(a){l({title:"加载失败",icon:"none"})}},j=()=>{C.value=!0},I=()=>{x.value=!0,D.value.tag=""},T=()=>{D.value.tag||(x.value=!1)},z=e=>{D.value.isDefault=e.detail.value},B=async()=>{if(!D.value.name)return l({title:"请输入联系人姓名",icon:"none"});if(!D.value.phone)return l({title:"请输入手机号",icon:"none"});if(!/^1[3-9]\d{9}$/.test(D.value.phone))return l({title:"手机号格式不正确",icon:"none"});if(!D.value.region)return l({title:"请选择所在地区",icon:"none"});if(!D.value.address)return l({title:"请输入详细地址",icon:"none"});try{await saveAddressApi(D.value),l({title:"保存成功",icon:"success"}),setTimeout((()=>{p()}),1500)}catch(e){l({title:"保存失败",icon:"none"})}},F=()=>{_({title:"提示",content:"确定要删除该地址吗？",success:async e=>{if(e.confirm)try{await deleteAddressApi(D.value.id),l({title:"删除成功",icon:"success"}),setTimeout((()=>{p()}),1500)}catch(a){l({title:"删除失败",icon:"none"})}}})};return(e,a)=>{const l=h,p=g,_=u,V=k,C=y,U=b;return c(),s(_,{class:"address-edit"},{default:t((()=>[o(_,{class:"form"},{default:t((()=>[o(_,{class:"form-item"},{default:t((()=>[o(l,{class:"label"},{default:t((()=>[n("联系人")])),_:1}),o(p,{class:"input",modelValue:D.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value.name=e),placeholder:"请输入姓名","placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1}),o(_,{class:"form-item"},{default:t((()=>[o(l,{class:"label"},{default:t((()=>[n("手机号")])),_:1}),o(p,{class:"input",type:"number",maxlength:"11",modelValue:D.value.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.phone=e),placeholder:"请输入手机号","placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1}),o(_,{class:"form-item",onClick:j},{default:t((()=>[o(l,{class:"label"},{default:t((()=>[n("所在地区")])),_:1}),o(_,{class:"area-picker"},{default:t((()=>[D.value.region?(c(),s(l,{key:0,class:"value"},{default:t((()=>[n(d(D.value.region),1)])),_:1})):(c(),s(l,{key:1,class:"placeholder"},{default:t((()=>[n("请选择所在地区")])),_:1})),o(l,{class:"arrow"},{default:t((()=>[n(">")])),_:1})])),_:1})])),_:1}),o(_,{class:"form-item"},{default:t((()=>[o(l,{class:"label"},{default:t((()=>[n("详细地址")])),_:1}),o(V,{class:"textarea",modelValue:D.value.address,"onUpdate:modelValue":a[2]||(a[2]=e=>D.value.address=e),placeholder:"请输入详细地址，如街道、楼牌号等","placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1}),o(_,{class:"form-item"},{default:t((()=>[o(l,{class:"label"},{default:t((()=>[n("标签")])),_:1}),o(_,{class:"tags"},{default:t((()=>[(c(),i(m,null,r(A,(e=>o(_,{key:e,class:f(["tag-item",{active:D.value.tag===e}]),onClick:a=>(e=>{D.value.tag=e,x.value=!1})(e)},{default:t((()=>[n(d(e),1)])),_:2},1032,["class","onClick"]))),64)),o(_,{class:f(["tag-item custom",{active:x.value}]),onClick:I},{default:t((()=>[x.value?(c(),s(p,{key:1,class:"custom-input",modelValue:D.value.tag,"onUpdate:modelValue":a[3]||(a[3]=e=>D.value.tag=e),onBlur:T,placeholder:"自定义标签"},null,8,["modelValue"])):(c(),s(l,{key:0},{default:t((()=>[n("自定义")])),_:1}))])),_:1},8,["class"])])),_:1})])),_:1}),o(_,{class:"form-item switch-item"},{default:t((()=>[o(l,{class:"label"},{default:t((()=>[n("设为默认地址")])),_:1}),o(C,{checked:D.value.isDefault,onChange:z,color:"#ff6b6b"},null,8,["checked"])])),_:1})])),_:1}),o(_,{class:"footer"},{default:t((()=>[o(_,{class:"btn-group"},{default:t((()=>[w.value?(c(),s(U,{key:0,class:"delete-btn",onClick:F},{default:t((()=>[n(" 删除 ")])),_:1})):v("",!0),o(U,{class:f(["save-btn",{"full-width":!w.value}]),onClick:B},{default:t((()=>[n(" 保存 ")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-8664e380"]]);export{w as default};
