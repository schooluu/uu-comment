import{o as a,c as e,w as t,a as l,i as s,d as c,r as n,g as u,b as o,e as d,f as i,h as f,n as r,u as _,t as p,j as m,k as v,l as y,F as g,m as k,Y as b,s as h,p as x,q as C,v as w,x as F,y as S,I as $,z as E,A as I,B as L}from"./index-UJd7_IDo.js";import{o as j,r as q,_ as T}from"./uni-rate.h5kmn-hW.js";import{_ as D}from"./uni-popup.D9MB7IGt.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=z({},[["render",function(c,n){const u=s;return a(),e(u,{class:"skeleton-card glass-effect"},{default:t((()=>[l(u,{class:"card-header"},{default:t((()=>[l(u,{class:"company-name skeleton-bg"}),l(u,{class:"rating-wrapper"},{default:t((()=>[l(u,{class:"rating skeleton-bg"})])),_:1})])),_:1}),l(u,{class:"card-content"},{default:t((()=>[l(u,{class:"cons-box skeleton-bg"})])),_:1}),l(u,{class:"card-footer"},{default:t((()=>[l(u,{class:"stats"},{default:t((()=>[l(u,{class:"stat-item skeleton-bg"}),l(u,{class:"stat-item skeleton-bg"}),l(u,{class:"date skeleton-bg"})])),_:1}),l(u,{class:"city-tag skeleton-bg"})])),_:1})])),_:1})}],["__scopeId","data-v-c515b885"]]),B=z(c({__name:"index",setup(c){const z=n([]),B=n(""),V=n(null),P=n(1),R=n(!0),Y=n(!1),H=n(""),M=n([]),N=n([]),U=n(""),G=u().statusBarHeight,J=a=>{const e=new Date(a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},K=async(a=1,e=!1)=>{e||(Y.value=!0);try{const{result:t}=await b.callFunction({name:"getCompanyList",data:{page:a,pageSize:10,keyword:B.value,city:H.value}});if(0===t.code){const l=t.data.map((a=>({...a,isExpanded:!1})));e?z.value=[...z.value,...l]:setTimeout((()=>{z.value=l,Y.value=!1}),500),R.value=10===t.data.length,P.value=a}}catch(t){h({title:"è·å–æ•°æ®å¤±è´¥",icon:"none"}),Y.value=!1}},O=()=>{z.value=[],P.value=1,R.value=!0,K(1)},Q=()=>{O()},W=()=>{B.value="",O()},X=()=>{x({url:"/pages/comment/add/add-review"})};o((()=>{d("hasShownDisclaimer")||V.value.open(),K()}));const Z=()=>{C("hasShownDisclaimer",!0),V.value.close()},aa=n(null),ea=()=>{aa.value.open()},ta=()=>{aa.value.close()},la=()=>{w({data:"962723968@qq.com",success:()=>{h({title:"é‚®ç®±å·²å¤åˆ¶",icon:"success"})}})};j((()=>{(async()=>{R.value&&!Y.value&&await K(P.value+1,!0)})()})),o((()=>{K()}));const sa=()=>{F({itemList:M.value.map((a=>a.name)),success:async a=>{const e=M.value[a.tapIndex];U.value=e.name,await(async a=>{try{const{result:e}=await b.callFunction({name:"getCityList",data:{province:a}});0===e.code&&(N.value=e.data)}catch(e){h({title:"è·å–åŸå¸‚å¤±è´¥",icon:"none"})}})(e.code),F({itemList:N.value.map((a=>a.name)),success:a=>{H.value=N.value[a.tapIndex].name,O()}})}})};o((async()=>{await(async()=>{try{const{result:a}=await b.callFunction({name:"getCityList"});0===a.code&&(M.value=a.data)}catch(a){h({title:"è·å–çœä»½å¤±è´¥",icon:"none"})}})(),K()}));const ca=n(0),na=n(0),ua=n(0),oa=()=>{h({title:`æ€»è®¡ ${ca.value} æ¡ç‚¹è¯„`,icon:"none"})},da=()=>{h({title:`å·²æ”¶å½• ${na.value} å®¶ä¼ä¸š`,icon:"none"})},ia=()=>{h({title:`ä»Šæ—¥æ–°å¢ ${ua.value} æ¡ç‚¹è¯„`,icon:"none"})};o((async()=>{await(async()=>{try{const{result:a}=await b.callFunction({name:"getStatistics"});0===a.code&&(ca.value=a.data.totalReviews,na.value=a.data.totalCompanies,ua.value=a.data.todayReviews)}catch(a){console.error("è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:",a)}})()}));const fa=n(d("theme")||"default"),ra=[{name:"default",label:"é»˜è®¤ç´«"},{name:"blue",label:"æ·±é‚ƒè“"},{name:"green",label:"è‡ªç„¶ç»¿"},{name:"red",label:"çƒ­æƒ…çº¢"}],_a=()=>{F({itemList:ra.map((a=>a.label)),success:a=>{var e,t;e=ra[a.tapIndex].name,fa.value=e,document.documentElement.setAttribute("data-theme",e),C("theme",e),h({title:`å·²åˆ‡æ¢è‡³${null==(t=ra.find((a=>a.name===e)))?void 0:t.label}ä¸»é¢˜`,icon:"none"})}})};return o((()=>{const a=d("theme");a&&document.documentElement.setAttribute("data-theme",a)})),(c,n)=>{const u=S,o=s,d=$,b=E,h=q(i("uni-rate"),T),C=I,w=q(i("uni-popup"),D);return a(),e(o,{class:"container"},{default:t((()=>[l(o,{class:"nav-bar",style:r({paddingTop:_(G)+"px"})},{default:t((()=>[l(o,{class:"nav-content"},{default:t((()=>[l(o,{class:"nav-left"},{default:t((()=>[l(u,{class:"app-title"},{default:t((()=>[f("äººäººç‚¹è¯„")])),_:1}),l(u,{class:"app-subtitle"},{default:t((()=>[f("åŒ¿ååŒ–ç‚¹è¯„ï¼Œé¿é›·æŒ‡å—")])),_:1})])),_:1}),l(o,{class:"nav-right"},{default:t((()=>[l(o,{class:"nav-btn theme-btn",onClick:_a},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ¨")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),l(o,{class:"intro-section",style:r({marginTop:_(G)+88+"rpx"})},{default:t((()=>[l(o,{class:"intro-cards"},{default:t((()=>[l(o,{class:"intro-card glass-effect",onClick:oa},{default:t((()=>[l(o,{class:"card-content"},{default:t((()=>[l(u,{class:"count"},{default:t((()=>[f(p(ca.value||"0"),1)])),_:1}),l(u,{class:"label"},{default:t((()=>[f("æ€»ç‚¹è¯„")])),_:1})])),_:1}),l(u,{class:"icon"},{default:t((()=>[f("ğŸ“")])),_:1})])),_:1}),l(o,{class:"intro-card glass-effect",onClick:da},{default:t((()=>[l(o,{class:"card-content"},{default:t((()=>[l(u,{class:"count"},{default:t((()=>[f(p(na.value||"0"),1)])),_:1}),l(u,{class:"label"},{default:t((()=>[f("å·²æ”¶å½•")])),_:1})])),_:1}),l(u,{class:"icon"},{default:t((()=>[f("ğŸ¢")])),_:1})])),_:1}),l(o,{class:"intro-card glass-effect",onClick:ia},{default:t((()=>[l(o,{class:"card-content"},{default:t((()=>[l(u,{class:"count"},{default:t((()=>[f(p(ua.value||"0"),1)])),_:1}),l(u,{class:"label"},{default:t((()=>[f("ä»Šæ—¥æ–°å¢")])),_:1})])),_:1}),l(u,{class:"icon"},{default:t((()=>[f("ğŸ”¥")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),l(o,{class:"search-section",style:r({marginTop:_(G)+"rpx"})},{default:t((()=>[l(o,{class:"search-wrapper glass-effect"},{default:t((()=>[l(o,{class:"search-input-box"},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ”")])),_:1}),l(d,{class:"input",modelValue:B.value,"onUpdate:modelValue":n[0]||(n[0]=a=>B.value=a),placeholder:"æœç´¢ç‚¹è¯„æ ‡é¢˜","placeholder-class":"placeholder","confirm-type":"search",onConfirm:Q},null,8,["modelValue"]),B.value?(a(),e(u,{key:0,class:"clear-icon",onClick:W},{default:t((()=>[f("âœ•")])),_:1})):m("",!0)])),_:1}),l(o,{class:"divider"}),l(o,{class:"location-picker",onClick:sa},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ“")])),_:1}),l(u,{class:"location-text"},{default:t((()=>[f(p(H.value||"é€‰æ‹©åŸå¸‚"),1)])),_:1}),l(u,{class:"icon-arrow"},{default:t((()=>[f("â–¼")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),Y.value?(a(),v(g,{key:0},y(5,(a=>l(A,{key:a}))),64)):m("",!0),l(o,{class:k(["company-list",{"fade-in":!Y.value}])},{default:t((()=>[Y.value?(a(),v(g,{key:0},[],64)):0===z.value.length?(a(),e(o,{key:1,class:"empty-state"},{default:t((()=>[l(b,{class:"empty-image",src:"./static/images/empty.png",mode:"aspectFit"}),l(u,{class:"empty-text"},{default:t((()=>[f("æš‚æ— æ•°æ®")])),_:1}),l(u,{class:"empty-tips"},{default:t((()=>[f("å¿«æ¥æ·»åŠ ç¬¬ä¸€æ¡è¯„ä»·å§")])),_:1}),l(o,{class:"empty-btn",onClick:X},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("âœï¸")])),_:1}),l(u,{class:"text"},{default:t((()=>[f("å†™ç‚¹è¯„")])),_:1})])),_:1})])),_:1})):(a(!0),v(g,{key:2},y(z.value,((s,c)=>(a(),e(o,{key:s._id,class:"company-card glass-effect",style:r({"--index":c}),"hover-class":"company-card-hover",onClick:a=>{return e=s._id,void x({url:`/pages/comment/detail/detail?id=${e}`});var e}},{default:t((()=>[l(o,{class:"card-header"},{default:t((()=>[l(u,{class:"company-name"},{default:t((()=>[f(p(s.companyName),1)])),_:2},1024),l(o,{class:"rating-wrapper"},{default:t((()=>[l(h,{value:s.rating,size:"18",color:"#FFB800"},null,8,["value"]),l(u,{class:"rating-text"},{default:t((()=>[f(p(s.rating||0),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),l(o,{class:"card-content"},{default:t((()=>[s.cons?(a(),e(o,{key:0,class:"cons-box"},{default:t((()=>{return[l(u,{class:k(["cons-text",{truncated:!s.isExpanded}])},{default:t((()=>[f(p(s.cons),1)])),_:2},1032,["class"]),(c=s.cons,c.length>100?(a(),e(u,{key:0,class:"expand-btn",onClick:L((a=>(a=>{a.isExpanded=!a.isExpanded})(s)),["stop"])},{default:t((()=>[f(p(s.isExpanded?"æ”¶èµ·":"æŸ¥çœ‹æ›´å¤š"),1)])),_:2},1032,["onClick"])):m("",!0))];var c})),_:2},1024)):m("",!0)])),_:2},1024),l(o,{class:"card-footer"},{default:t((()=>[l(o,{class:"stats"},{default:t((()=>[l(o,{class:"stat-item"},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ‘ï¸")])),_:1}),l(u,{class:"count"},{default:t((()=>[f(p(s.viewCount||0),1)])),_:2},1024)])),_:2},1024),l(o,{class:"stat-item"},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ’¬")])),_:1}),l(u,{class:"count"},{default:t((()=>[f(p(s.reviewCount||0),1)])),_:2},1024)])),_:2},1024),l(u,{class:"date"},{default:t((()=>[f(p(J(s.createTime)),1)])),_:2},1024)])),_:2},1024),l(u,{class:"city-tag"},{default:t((()=>[f(p(s.city),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1},8,["class"]),l(o,{class:"float-btns"},{default:t((()=>[l(o,{class:"float-btn glass-effect complaint-btn",onClick:ea},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ“¢")])),_:1})])),_:1}),l(o,{class:"float-btn glass-effect",onClick:X},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("âœï¸")])),_:1})])),_:1})])),_:1}),l(w,{ref_key:"disclaimerPopup",ref:V,type:"center"},{default:t((()=>[l(o,{class:"disclaimer-popup"},{default:t((()=>[l(o,{class:"popup-header"},{default:t((()=>[l(u,{class:"title"},{default:t((()=>[f("å…è´£å£°æ˜")])),_:1})])),_:1}),l(o,{class:"popup-content"},{default:t((()=>[l(u,{class:"text"},{default:t((()=>[f("1. æœ¬å¹³å°ä»…æä¾›ä¿¡æ¯åˆ†äº«æœåŠ¡ï¼Œæ‰€æœ‰å†…å®¹å‡æ¥è‡ªç”¨æˆ·å‘å¸ƒã€‚")])),_:1}),l(u,{class:"text"},{default:t((()=>[f("2. ç”¨æˆ·å‘å¸ƒçš„å†…å®¹ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œè¯·ç†æ€§å¯¹å¾…ã€‚")])),_:1}),l(u,{class:"text"},{default:t((()=>[f("3. å¦‚å‘ç°è¿è§„å†…å®¹ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬å¤„ç†ã€‚")])),_:1}),l(u,{class:"text"},{default:t((()=>[f("4. å¹³å°ä¿ç•™å¯¹è¿è§„å†…å®¹çš„å¤„ç†æƒåˆ©ã€‚")])),_:1})])),_:1}),l(o,{class:"popup-footer"},{default:t((()=>[l(C,{class:"confirm-btn",onClick:Z},{default:t((()=>[f("æˆ‘å·²äº†è§£")])),_:1})])),_:1})])),_:1})])),_:1},512),z.value.length>0?(a(),e(o,{key:1,class:"load-more"},{default:t((()=>[Y.value?(a(),e(o,{key:0,class:"loading"},{default:t((()=>[l(o,{class:"loading-icon"}),l(u,{class:"loading-text"},{default:t((()=>[f("åŠ è½½ä¸­...")])),_:1})])),_:1})):R.value?m("",!0):(a(),e(u,{key:1,class:"no-more"},{default:t((()=>[f("æ²¡æœ‰æ›´å¤šäº†")])),_:1}))])),_:1})):m("",!0),l(w,{ref_key:"complaintPopup",ref:aa,type:"center"},{default:t((()=>[l(o,{class:"complaint-popup glass-effect"},{default:t((()=>[l(o,{class:"popup-header"},{default:t((()=>[l(u,{class:"title"},{default:t((()=>[f("æŠ•è¯‰å»ºè®®")])),_:1}),l(u,{class:"close-icon",onClick:ta},{default:t((()=>[f("âœ•")])),_:1})])),_:1}),l(o,{class:"popup-content"},{default:t((()=>[l(o,{class:"content-item"},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("ğŸ“§")])),_:1}),l(o,{class:"item-info"},{default:t((()=>[l(u,{class:"label"},{default:t((()=>[f("é‚®ç®±è”ç³»")])),_:1}),l(u,{class:"value"},{default:t((()=>[f("962723968@qq.com")])),_:1})])),_:1}),l(C,{class:"copy-btn",onClick:la},{default:t((()=>[f("å¤åˆ¶")])),_:1})])),_:1}),l(o,{class:"content-item"},{default:t((()=>[l(u,{class:"icon"},{default:t((()=>[f("âš ï¸")])),_:1}),l(o,{class:"item-info"},{default:t((()=>[l(u,{class:"label"},{default:t((()=>[f("æ¸©é¦¨æç¤º")])),_:1}),l(u,{class:"desc"},{default:t((()=>[f("å¦‚å‘ç°ä»»ä½•è¿è§„æˆ–ä¸å½“å†…å®¹ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬å¤„ç†ï¼Œæˆ‘ä»¬ä¼šåœ¨24å°æ—¶å†…ç»™äºˆå›å¤ã€‚")])),_:1})])),_:1})])),_:1})])),_:1}),l(o,{class:"popup-footer"},{default:t((()=>[l(C,{class:"confirm-btn",onClick:ta},{default:t((()=>[f("æˆ‘çŸ¥é“äº†")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}}),[["__scopeId","data-v-06fd2e23"]]);export{B as default};
