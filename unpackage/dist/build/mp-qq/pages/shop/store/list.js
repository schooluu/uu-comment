"use strict";const e=require("../../../common/vendor.js"),t={__name:"list",setup(t){const s=e.ref(""),a=e.ref("正在定位..."),u=["全部门店","距离最近","评分最高","新开门店"],i=e.ref(0),o=e.ref(!1),n=e.ref(!1),l=e.ref([{id:1,name:"喜茶北京三里屯店",image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",distance:.8,address:"北京市朝阳区三里屯太古里北区N8-B1-3",features:["可预约","WIFI","礼品卡","室内停车"],status:"open",statusText:"营业中",businessHours:"10:00-22:00",latitude:39.934,longitude:116.455},{id:1,name:"喜茶北京三里屯店",image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",distance:.8,address:"北京市朝阳区三里屯太古里北区N8-B1-3",features:["可预约","WIFI","礼品卡","室内停车"],status:"open",statusText:"营业中",businessHours:"10:00-22:00",latitude:39.934,longitude:116.455},{id:1,name:"喜茶北京三里屯店",image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",distance:.8,address:"北京市朝阳区三里屯太古里北区N8-B1-3",features:["可预约","WIFI","礼品卡","室内停车"],status:"open",statusText:"营业中",businessHours:"10:00-22:00",latitude:39.934,longitude:116.455}]),d=()=>{e.index.getLocation({type:"gcj02",success:t=>{e.index.request({url:`https://api.map.baidu.com/reverse_geocoding/v3/?ak=YOUR_KEY&location=${t.latitude},${t.longitude}`,success:e=>{a.value=e.data.result.address_component.street}})},fail:()=>{a.value="定位失败"}})},r=()=>{a.value="定位中...",d(),T()},c=()=>{if(!s.value.trim())return void p();const e=s.value.toLowerCase();l.value=l.value.filter((t=>t.name.toLowerCase().includes(e)||t.address.toLowerCase().includes(e)))},v=t=>{event.stopPropagation(),"closed"!==t.status?"busy"!==t.status?(t=>{e.index.navigateTo({url:`/pages/shop/store/goodsList?id=${t.id}`})})(t):e.index.showModal({title:"门店忙碌提醒",content:"当前门店较为繁忙，可能需要较长等待时间，是否继续下单？",confirmText:"继续下单",cancelText:"换个门店",success:e=>{e.confirm}}):e.index.showToast({title:"门店已打烊，请明天再来",icon:"none",duration:2e3})},g=async()=>{o.value=!0,setTimeout((()=>{o.value=!1}),1e3)},m=()=>{n.value||(n.value=!0,setTimeout((()=>{n.value=!1}),1e3))},p=()=>{n.value=!0,setTimeout((()=>{n.value=!1}),500)},f=()=>{l.value.sort(((e,t)=>e.distance-t.distance))},b=()=>{l.value.sort(((e,t)=>t.rating-e.rating))},h=()=>{n.value=!0,setTimeout((()=>{l.value=[],n.value=!1}),500)},T=()=>{n.value=!0,setTimeout((()=>{l.value=[],n.value=!1}),500)};return e.onMounted((()=>{d(),p()})),(t,d)=>e.e({a:e.o([e=>s.value=e.detail.value,c]),b:s.value,c:e.t(a.value),d:e.o(r),e:e.f(u,((s,a,u)=>({a:e.t(t.filterIcons[a]),b:e.t(s),c:a,d:i.value===a?1:"",e:e.o((e=>(e=>{if(i.value!==e)switch(i.value=e,e){case 0:p();break;case 1:f();break;case 2:b();break;case 3:h()}})(a)),a)}))),f:e.f(l.value,((t,s,a)=>({a:t.image,b:e.t(t.name),c:e.t(t.distance),d:e.t(t.address),e:e.o((s=>(t=>{event.stopPropagation(),e.index.openLocation({latitude:t.latitude,longitude:t.longitude,name:t.name,address:t.address,scale:18})})(t)),t.id),f:e.f(t.features,((t,s,a)=>({a:e.t(t),b:s}))),g:e.t("open"===t.status?"🟢":"busy"===t.status?"🟡":"⚪️"),h:e.t(t.statusText),i:e.n(t.status),j:e.t(t.businessHours),k:e.t("closed"===t.status?"🌙":"🛍️"),l:e.t("closed"===t.status?"已打烊":"去下单"),m:"closed"===t.status?1:"",n:e.o((e=>v(t)),t.id),o:t.id,p:e.o((s=>(t=>{e.index.navigateTo({url:`/pages/shop/store/detail?id=${t.id}`})})(t)),t.id)}))),g:n.value},(n.value,{}),{h:0===l.value.length&&!n.value},(0!==l.value.length||n.value,{}),{i:e.o(m),j:o.value,k:e.o(g)})}};qq.createPage(t);
