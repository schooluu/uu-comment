"use strict";const e=require("../../../common/vendor.js");if(!Array){e.resolveComponent("uni-popup")()}Math;const a={__name:"goodsList",setup(a){const i=e.ref([{image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg"},{image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg"},{image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg"}]),o=e.ref([{id:1,name:"æŽ¨è",icon:"ðŸ”¥"},{id:2,name:"æ–°å“",icon:"ðŸ†•"},{id:3,name:"å¥¶èŒ¶",icon:"ðŸ§‹"},{id:4,name:"æžœèŒ¶",icon:"ðŸŠ"},{id:5,name:"å’–å•¡",icon:"â˜•ï¸"},{id:6,name:"å°åƒ",icon:"ðŸª"},{id:7,name:"åŠ æ–™",icon:"ðŸ§‡"}]),t=e.ref([]),n=e.ref(0),l=e.ref(!1),c=e.ref(!1),u=e.ref({}),s=e.ref(null),d=e.computed((()=>Object.values(u.value).reduce(((e,a)=>e+a),0))),r=e.computed((()=>t.value.reduce(((e,a)=>{const i=u.value[a.id]||0;return e+a.price*i}),0))),v=e.computed((()=>t.value.filter((e=>u.value[e.id])).map((e=>({...e,count:u.value[e.id]}))))),m=(a,i)=>{const o=(u.value[a.id]||0)+i;if(!(o<0)){if(0===o)delete u.value[a.id];else{if(o>a.stock)return void e.index.showToast({title:"åº“å­˜ä¸è¶³",icon:"none"});u.value[a.id]=o}f()}},p=()=>{r.value<20?e.index.showToast({title:`è¿˜å·®${(20-r.value).toFixed(2)}å…ƒèµ·é€`,icon:"none"}):e.index.navigateTo({url:"/pages/shop/store/checkout"})},g=()=>{e.index.showModal({title:"æç¤º",content:"ç¡®å®šæ¸…ç©ºè´­ç‰©è½¦å—ï¼Ÿ",success:e=>{e.confirm&&(u.value={},f(),s.value.close())}})},f=()=>{e.index.setStorageSync("cartItems",u.value)},h=()=>{s.value.open()},b=()=>{l.value||y(o.value[n.value].id)},x=async()=>{c.value=!0,await y(o.value[n.value].id),c.value=!1},y=async a=>{l.value=!0;try{setTimeout((()=>{t.value=Array(10).fill().map(((e,a)=>({id:a+1,name:"å•†å“åç§°",description:"å•†å“æè¿°ä¿¡æ¯",price:Math.floor(50*Math.random()+10),image:"https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg",stock:Math.floor(100*Math.random()),sold:Math.floor(1e3*Math.random())}))),l.value=!1}),500)}catch(i){console.error(i),e.index.showToast({title:"åŠ è½½å¤±è´¥",icon:"none"}),l.value=!1}};return e.onMounted((()=>{(()=>{const a=e.index.getStorageSync("cartItems");a&&(u.value=a)})(),y(o.value[0].id)})),(a,u)=>e.e({a:e.f(i.value,((e,a,i)=>({a:e.image,b:a}))),b:e.f(o.value,((a,i,t)=>({a:e.t(a.icon),b:e.t(a.name),c:a.id,d:n.value===i?1:"",e:e.o((e=>(async e=>{n.value!==e&&(n.value=e,await y(o.value[e].id))})(i)),a.id)}))),c:e.f(t.value,((a,i,o)=>e.e({a:a.image,b:e.t(a.name),c:e.t(a.description),d:e.t(a.price),e:a.originalPrice},a.originalPrice?{f:e.t(a.originalPrice)}:{},{g:e.t(a.sold),h:a.stock?"":1,i:e.o((i=>(a=>{a.stock?m(a,1):e.index.showToast({title:"å•†å“å·²å”®ç½„",icon:"none"})})(a)),a.id),j:a.id,k:e.o((i=>(a=>{e.index.navigateTo({url:`/pages/shop/goods/detail?id=${a.id}`})})(a)),a.id)}))),d:l.value},(l.value,{}),{e:e.o(b),f:c.value,g:e.o(x),h:d.value>0},d.value>0?{i:e.t(d.value),j:e.t(r.value.toFixed(2)),k:e.t(3),l:e.t(r.value<20?"Â¥20èµ·é€":"åŽ»ç»“ç®—"),m:r.value<20?1:"",n:e.o(p),o:e.o(h)}:{},{p:e.o(g),q:e.f(v.value,((a,i,o)=>({a:a.image,b:e.t(a.name),c:e.t(a.price),d:e.o((e=>m(a,-1)),a.id),e:e.t(a.count),f:e.o((e=>m(a,1)),a.id),g:a.id}))),r:e.sr(s,"27fc341a-0",{k:"cartPopup"}),s:e.p({type:"bottom"})})}};qq.createPage(a);
