"use strict";const e=require("../../../common/vendor.js"),a={__name:"address-edit",setup(a){const t=e.ref(!1),n=e.ref(!1),o=e.ref(!1),i=["家","公司","学校"],s=e.ref({name:"",phone:"",region:"",address:"",tag:"",isDefault:!1});e.onMounted((()=>{const e=getQueryString("id");e&&(t.value=!0,l(e))}));const l=async a=>{try{const e=await getAddressDetail(a);s.value=e}catch(t){e.index.showToast({title:"加载失败",icon:"none"})}},u=()=>{n.value=!0},v=()=>{o.value=!0,s.value.tag=""},d=()=>{s.value.tag||(o.value=!1)},r=e=>{s.value.isDefault=e.detail.value},c=async()=>{if(!s.value.name)return e.index.showToast({title:"请输入联系人姓名",icon:"none"});if(!s.value.phone)return e.index.showToast({title:"请输入手机号",icon:"none"});if(!/^1[3-9]\d{9}$/.test(s.value.phone))return e.index.showToast({title:"手机号格式不正确",icon:"none"});if(!s.value.region)return e.index.showToast({title:"请选择所在地区",icon:"none"});if(!s.value.address)return e.index.showToast({title:"请输入详细地址",icon:"none"});try{await saveAddressApi(s.value),e.index.showToast({title:"保存成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1500)}catch(a){e.index.showToast({title:"保存失败",icon:"none"})}},h=()=>{e.index.showModal({title:"提示",content:"确定要删除该地址吗？",success:async a=>{if(a.confirm)try{await deleteAddressApi(s.value.id),e.index.showToast({title:"删除成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1500)}catch(t){e.index.showToast({title:"删除失败",icon:"none"})}}})};return(a,n)=>e.e({a:s.value.name,b:e.o((e=>s.value.name=e.detail.value)),c:s.value.phone,d:e.o((e=>s.value.phone=e.detail.value)),e:s.value.region},s.value.region?{f:e.t(s.value.region)}:{},{g:e.o(u),h:s.value.address,i:e.o((e=>s.value.address=e.detail.value)),j:e.f(i,((a,t,n)=>({a:e.t(a),b:a,c:s.value.tag===a?1:"",d:e.o((e=>(e=>{s.value.tag=e,o.value=!1})(a)),a)}))),k:!o.value},o.value?{l:e.o(d),m:s.value.tag,n:e.o((e=>s.value.tag=e.detail.value))}:{},{o:o.value?1:"",p:e.o(v),q:s.value.isDefault,r:e.o(r),s:t.value},t.value?{t:e.o(h)}:{},{v:t.value?"":1,w:e.o(c)})}};qq.createPage(a);
